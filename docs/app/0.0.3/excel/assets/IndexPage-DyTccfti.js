var mn=Object.defineProperty;var la=e=>{throw TypeError(e)};var pn=(e,t,a)=>t in e?mn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var Ne=(e,t,a)=>pn(e,typeof t!="symbol"?t+"":t,a),vn=(e,t,a)=>t.has(e)||la("Cannot "+a);var ye=(e,t,a)=>(vn(e,t,"read from private field"),a?a.call(e):t.get(e)),Pt=(e,t,a)=>t.has(e)?la("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,a);import{c as ve,g as ge,r as B,a as O,w as J,o as Ce,W as at,X as Ue,h as L,T as ot,b as fe,v as Be,i as wt,e as Ae,Y as $a,m as Qe,K as Ht,Z as hn,Q as Te,j as yn,_ as bn,$ as La,a0 as Fa,a1 as Va,p as wn,a2 as _n,a3 as pe,a4 as It,n as Tn,t as ia,a5 as Cn,a6 as Sn,a7 as kn,a8 as An,l as xn,d as Rn,a9 as En,aa as Pn,ab as ua,k as Oe,ac as In,u as qn,ad as On,ae as Mn,af as $n,ag as Ba,U as Fe,ah as Ge,ai as Ln,A as ca,aj as Fn,B as At,q as Vn,D as we,E as de,I as H,H as K,F as Ee,ak as ce,G as be,J as te,L as ie,z as Pe,O as Bn,M as pt,S as Dn,al as ut}from"./index-Da3EV6z-.js";import{k as vt,i as Da,s as zn,v as Nn,j as da,l as za,Y as Un,x as fa,n as nt,o as st,p as Na,q as Hn,r as jn,t as Ua,w as Ha,z as Kn,B as ga,F as Qn,Z as jt,g as Wn,Q as Gn,f as Yt,h as Zt,u as Yn,d as Zn,e as Xn,b as Jn,a as eo,$ as to,C as ao,y as no,D as ma,A as pa,G as Xt,H as oo,a0 as so,a1 as ro,a2 as lo,J as De,a3 as xe,a4 as ae,a5 as Jt,a6 as he,a7 as io,a8 as uo,a9 as co,aa as ct,ab as fo,N as go,O as mo,ac as Kt,ad as po,X as va,ae as Ye,U as vo,P as ho,_ as yo}from"./_plugin-vue_export-helper-C8gwU05P.js";const je=ve({name:"QTooltip",inheritAttrs:!1,props:{...Un,...za,...vt,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...vt.transitionShow,default:"jump-down"},transitionHide:{...vt.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:da},self:{type:String,default:"top middle",validator:da},offset:{type:Array,default:()=>[14,14],validator:Nn},scrollTarget:zn,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...Da],setup(e,{slots:t,emit:a,attrs:n}){let s,o;const r=ge(),{proxy:{$q:l}}=r,d=B(null),c=B(!1),w=O(()=>fa(e.anchor,l.lang.rtl)),T=O(()=>fa(e.self,l.lang.rtl)),y=O(()=>e.persistent!==!0),{registerTick:A,removeTick:I}=nt(),{registerTimeout:$}=st(),{transitionProps:k,transitionStyle:N}=Na(e),{localScrollTarget:Q,changeScrollEvent:M,unconfigureScrollTarget:v}=Hn(e,le),{anchorEl:C,canShow:f,anchorEvents:x}=jn({showing:c,configureAnchorEl:F}),{show:q,hide:z}=Ua({showing:c,canShow:f,handleShow:S,handleHide:u,hideOnRouteChange:y,processOnMount:!0});Object.assign(x,{delayShow:E,delayHide:h});const{showPortal:m,hidePortal:g,renderPortal:R}=Ha(r,d,b,"tooltip");if(l.platform.is.mobile===!0){const U={anchorEl:C,innerRef:d,onClickOutside(ne){return z(ne),ne.target.classList.contains("q-dialog__backdrop")&&Be(ne),!0}},ee=O(()=>e.modelValue===null&&e.persistent!==!0&&c.value===!0);J(ee,ne=>{(ne===!0?Kn:ga)(U)}),Ce(()=>{ga(U)})}function S(U){m(),A(()=>{o=new MutationObserver(()=>_()),o.observe(d.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),_(),le()}),s===void 0&&(s=J(()=>l.screen.width+"|"+l.screen.height+"|"+e.self+"|"+e.anchor+"|"+l.lang.rtl,_)),$(()=>{m(!0),a("show",U)},e.transitionDuration)}function u(U){I(),g(),i(),$(()=>{g(!0),a("hide",U)},e.transitionDuration)}function i(){o!==void 0&&(o.disconnect(),o=void 0),s!==void 0&&(s(),s=void 0),v(),at(x,"tooltipTemp")}function _(){Qn({targetEl:d.value,offset:e.offset,anchorEl:C.value,anchorOrigin:w.value,selfOrigin:T.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function E(U){if(l.platform.is.mobile===!0){jt(),document.body.classList.add("non-selectable");const ee=C.value,ne=["touchmove","touchcancel","touchend","click"].map(D=>[ee,D,"delayHide","passiveCapture"]);Ue(x,"tooltipTemp",ne)}$(()=>{q(U)},e.delay)}function h(U){l.platform.is.mobile===!0&&(at(x,"tooltipTemp"),jt(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),$(()=>{z(U)},e.hideDelay)}function F(){if(e.noParentEvent===!0||C.value===null)return;const U=l.platform.is.mobile===!0?[[C.value,"touchstart","delayShow","passive"]]:[[C.value,"mouseenter","delayShow","passive"],[C.value,"mouseleave","delayHide","passive"]];Ue(x,"anchor",U)}function le(){if(C.value!==null||e.scrollTarget!==void 0){Q.value=Wn(C.value,e.scrollTarget);const U=e.noParentEvent===!0?_:z;M(Q.value,U)}}function j(){return c.value===!0?L("div",{...n,ref:d,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",n.class],style:[n.style,N.value],role:"tooltip"},fe(t.default)):null}function b(){return L(ot,k.value,j)}return Ce(i),Object.assign(r.proxy,{updatePosition:_}),R}});let bo=0;const wo=["click","keydown"],_o={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${bo++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function To(e,t,a,n){const s=wt($a,Ae);if(s===Ae)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Ae;const{proxy:o}=ge(),r=B(null),l=B(null),d=B(null),c=O(()=>e.disable===!0||e.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},e.ripple===!0?{}:e.ripple)),w=O(()=>s.currentModel.value===e.name),T=O(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(w.value===!0?" q-tab--active"+(s.tabProps.value.activeClass?" "+s.tabProps.value.activeClass:"")+(s.tabProps.value.activeColor?` text-${s.tabProps.value.activeColor}`:"")+(s.tabProps.value.activeBgColor?` bg-${s.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&s.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(e.noCaps===!0||s.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(e.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")),y=O(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(s.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(e.contentClass!==void 0?` ${e.contentClass}`:"")),A=O(()=>e.disable===!0||s.hasFocus.value===!0||w.value===!1&&s.hasActiveTab.value===!0?-1:e.tabindex||0);function I(M,v){if(v!==!0&&M?.qAvoidFocus!==!0&&r.value?.focus(),e.disable!==!0){s.updateModel({name:e.name}),a("click",M);return}}function $(M){bn(M,[13,32])?I(M,!0):La(M)!==!0&&M.keyCode>=35&&M.keyCode<=40&&M.altKey!==!0&&M.metaKey!==!0&&s.onKbdNavigate(M.keyCode,o.$el)===!0&&Be(M),a("keydown",M)}function k(){const M=s.tabProps.value.narrowIndicator,v=[],C=L("div",{ref:d,class:["q-tab__indicator",s.tabProps.value.indicatorClass]});e.icon!==void 0&&v.push(L(Te,{class:"q-tab__icon",name:e.icon})),e.label!==void 0&&v.push(L("div",{class:"q-tab__label"},e.label)),e.alert!==!1&&v.push(e.alertIcon!==void 0?L(Te,{class:"q-tab__alert-icon",color:e.alert!==!0?e.alert:void 0,name:e.alertIcon}):L("div",{class:"q-tab__alert"+(e.alert!==!0?` text-${e.alert}`:"")})),M===!0&&v.push(C);const f=[L("div",{class:"q-focus-helper",tabindex:-1,ref:r}),L("div",{class:y.value},yn(t.default,v))];return M===!1&&f.push(C),f}const N={name:O(()=>e.name),rootRef:l,tabIndicatorRef:d,routeData:n};Ce(()=>{s.unregisterTab(N)}),Qe(()=>{s.registerTab(N)});function Q(M,v){const C={ref:l,class:T.value,tabindex:A.value,role:"tab","aria-selected":w.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:I,onKeydown:$,...v};return Ht(L(M,C,k()),[[hn,c.value]])}return{renderTab:Q,$tabs:s}}const qt=ve({name:"QTab",props:_o,emits:wo,setup(e,{slots:t,emit:a}){const{renderTab:n}=To(e,t,a);return()=>n("div")}});let ja=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const t=document.createElement("div");Object.assign(t.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(t),e.scrollLeft=-1e3,ja=e.scrollLeft>=0,e.remove()}function Co(e,t,a){const n=a===!0?["left","right"]:["top","bottom"];return`absolute-${t===!0?n[0]:n[1]}${e?` text-${e}`:""}`}const So=["left","center","right","justify"],ko=ve({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>So.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:t,emit:a}){const{proxy:n}=ge(),{$q:s}=n,{registerTick:o}=nt(),{registerTick:r}=nt(),{registerTick:l}=nt(),{registerTimeout:d,removeTimeout:c}=st(),{registerTimeout:w,removeTimeout:T}=st(),y=B(null),A=B(null),I=B(e.modelValue),$=B(!1),k=B(!0),N=B(!1),Q=B(!1),M=[],v=B(0),C=B(!1);let f=null,x=null,q;const z=O(()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:Co(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps})),m=O(()=>{const P=v.value,V=I.value;for(let W=0;W<P;W++)if(M[W].name.value===V)return!0;return!1}),g=O(()=>`q-tabs__content--align-${$.value===!0?"left":Q.value===!0?"justify":e.align}`),R=O(()=>`q-tabs row no-wrap items-center q-tabs--${$.value===!0?"":"not-"}scrollable q-tabs--${e.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${e.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${e.mobileArrows===!0?"":"out"}-arrows`+(e.dense===!0?" q-tabs--dense":"")+(e.shrink===!0?" col-shrink":"")+(e.stretch===!0?" self-stretch":"")),S=O(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+g.value+(e.contentClass!==void 0?` ${e.contentClass}`:"")),u=O(()=>e.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),i=O(()=>e.vertical!==!0&&s.lang.rtl===!0),_=O(()=>ja===!1&&i.value===!0);J(i,b),J(()=>e.modelValue,P=>{E({name:P,setCurrent:!0,skipEmit:!0})}),J(()=>e.outsideArrows,h);function E({name:P,setCurrent:V,skipEmit:W}){I.value!==P&&(W!==!0&&e["onUpdate:modelValue"]!==void 0&&a("update:modelValue",P),(V===!0||e["onUpdate:modelValue"]===void 0)&&(le(I.value,P),I.value=P))}function h(){o(()=>{y.value&&F({width:y.value.offsetWidth,height:y.value.offsetHeight})})}function F(P){if(u.value===void 0||A.value===null)return;const V=P[u.value.container],W=Math.min(A.value[u.value.scroll],Array.prototype.reduce.call(A.value.children,(se,X)=>se+(X[u.value.content]||0),0)),oe=V>0&&W>V;$.value=oe,oe===!0&&r(b),Q.value=V<parseInt(e.breakpoint,10)}function le(P,V){const W=P!=null&&P!==""?M.find(se=>se.name.value===P):null,oe=V!=null&&V!==""?M.find(se=>se.name.value===V):null;if(it===!0)it=!1;else if(W&&oe){const se=W.tabIndicatorRef.value,X=oe.tabIndicatorRef.value;f!==null&&(clearTimeout(f),f=null),se.style.transition="none",se.style.transform="none",X.style.transition="none",X.style.transform="none";const Z=se.getBoundingClientRect(),ue=X.getBoundingClientRect();X.style.transform=e.vertical===!0?`translate3d(0,${Z.top-ue.top}px,0) scale3d(1,${ue.height?Z.height/ue.height:1},1)`:`translate3d(${Z.left-ue.left}px,0,0) scale3d(${ue.width?Z.width/ue.width:1},1,1)`,l(()=>{f=setTimeout(()=>{f=null,X.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",X.style.transform="none"},70)})}oe&&$.value===!0&&j(oe.rootRef.value)}function j(P){const{left:V,width:W,top:oe,height:se}=A.value.getBoundingClientRect(),X=P.getBoundingClientRect();let Z=e.vertical===!0?X.top-oe:X.left-V;if(Z<0){A.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(Z),b();return}Z+=e.vertical===!0?X.height-se:X.width-W,Z>0&&(A.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(Z),b())}function b(){const P=A.value;if(P===null)return;const V=P.getBoundingClientRect(),W=e.vertical===!0?P.scrollTop:Math.abs(P.scrollLeft);i.value===!0?(k.value=Math.ceil(W+V.width)<P.scrollWidth-1,N.value=W>0):(k.value=W>0,N.value=e.vertical===!0?Math.ceil(W+V.height)<P.scrollHeight:Math.ceil(W+V.width)<P.scrollWidth)}function U(P){x!==null&&clearInterval(x),x=setInterval(()=>{lt(P)===!0&&D()},5)}function ee(){U(_.value===!0?Number.MAX_SAFE_INTEGER:0)}function ne(){U(_.value===!0?0:Number.MAX_SAFE_INTEGER)}function D(){x!==null&&(clearInterval(x),x=null)}function G(P,V){const W=Array.prototype.filter.call(A.value.children,ue=>ue===V||ue.matches&&ue.matches(".q-tab.q-focusable")===!0),oe=W.length;if(oe===0)return;if(P===36)return j(W[0]),W[0].focus(),!0;if(P===35)return j(W[oe-1]),W[oe-1].focus(),!0;const se=P===(e.vertical===!0?38:37),X=P===(e.vertical===!0?40:39),Z=se===!0?-1:X===!0?1:void 0;if(Z!==void 0){const ue=i.value===!0?-1:1,Se=W.indexOf(V)+Z*ue;return Se>=0&&Se<oe&&(j(W[Se]),W[Se].focus({preventScroll:!0})),!0}}const me=O(()=>_.value===!0?{get:P=>Math.abs(P.scrollLeft),set:(P,V)=>{P.scrollLeft=-V}}:e.vertical===!0?{get:P=>P.scrollTop,set:(P,V)=>{P.scrollTop=V}}:{get:P=>P.scrollLeft,set:(P,V)=>{P.scrollLeft=V}});function lt(P){const V=A.value,{get:W,set:oe}=me.value;let se=!1,X=W(V);const Z=P<X?-1:1;return X+=Z*5,X<0?(se=!0,X=0):(Z===-1&&X<=P||Z===1&&X>=P)&&(se=!0,X=P),oe(V,X),b(),se}function ze(P,V){for(const W in P)if(P[W]!==V[W])return!1;return!0}function rn(){let P=null,V={matchedLen:0,queryDiff:9999,hrefLen:0};const W=M.filter(Z=>Z.routeData?.hasRouterLink.value===!0),{hash:oe,query:se}=n.$route,X=Object.keys(se).length;for(const Z of W){const ue=Z.routeData.exact.value===!0;if(Z.routeData[ue===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:Se,query:Rt,matched:fn,href:gn}=Z.routeData.resolvedLink.value,Et=Object.keys(Rt).length;if(ue===!0){if(Se!==oe||Et!==X||ze(se,Rt)===!1)continue;P=Z.name.value;break}if(Se!==""&&Se!==oe||Et!==0&&ze(Rt,se)===!1)continue;const Re={matchedLen:fn.length,queryDiff:X-Et,hrefLen:gn.length-Se.length};if(Re.matchedLen>V.matchedLen){P=Z.name.value,V=Re;continue}else if(Re.matchedLen!==V.matchedLen)continue;if(Re.queryDiff<V.queryDiff)P=Z.name.value,V=Re;else if(Re.queryDiff!==V.queryDiff)continue;Re.hrefLen>V.hrefLen&&(P=Z.name.value,V=Re)}if(P===null&&M.some(Z=>Z.routeData===void 0&&Z.name.value===I.value)===!0){it=!1;return}E({name:P,setCurrent:!0})}function ln(P){if(c(),C.value!==!0&&y.value!==null&&P.target&&typeof P.target.closest=="function"){const V=P.target.closest(".q-tab");V&&y.value.contains(V)===!0&&(C.value=!0,$.value===!0&&j(V))}}function un(){d(()=>{C.value=!1},30)}function We(){oa.avoidRouteWatcher===!1?w(rn):T()}function na(){if(q===void 0){const P=J(()=>n.$route.fullPath,We);q=()=>{P(),q=void 0}}}function cn(P){M.push(P),v.value++,h(),P.routeData===void 0||n.$route===void 0?w(()=>{if($.value===!0){const V=I.value,W=V!=null&&V!==""?M.find(oe=>oe.name.value===V):null;W&&j(W.rootRef.value)}}):(na(),P.routeData.hasRouterLink.value===!0&&We())}function dn(P){M.splice(M.indexOf(P),1),v.value--,h(),q!==void 0&&P.routeData!==void 0&&(M.every(V=>V.routeData===void 0)===!0&&q(),We())}const oa={currentModel:I,tabProps:z,hasFocus:C,hasActiveTab:m,registerTab:cn,unregisterTab:dn,verifyRouteModel:We,updateModel:E,onKbdNavigate:G,avoidRouteWatcher:!1};wn($a,oa);function sa(){f!==null&&clearTimeout(f),D(),q?.()}let ra,it;return Ce(sa),Fa(()=>{ra=q!==void 0,sa()}),Va(()=>{ra===!0&&(na(),it=!0,We()),h()}),()=>L("div",{ref:y,class:R.value,role:"tablist",onFocusin:ln,onFocusout:un},[L(Gn,{onResize:F}),L("div",{ref:A,class:S.value,onScroll:b},fe(t.default)),L(Te,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(k.value===!0?"":" q-tabs__arrow--faded"),name:e.leftIcon||s.iconSet.tabs[e.vertical===!0?"up":"left"],onMousedownPassive:ee,onTouchstartPassive:ee,onMouseupPassive:D,onMouseleavePassive:D,onTouchendPassive:D}),L(Te,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(N.value===!0?"":" q-tabs__arrow--faded"),name:e.rightIcon||s.iconSet.tabs[e.vertical===!0?"down":"right"],onMousedownPassive:ne,onTouchstartPassive:ne,onMouseupPassive:D,onMouseleavePassive:D,onTouchendPassive:D})])}}),ea={left:!0,right:!0,up:!0,down:!0,horizontal:!0,vertical:!0},Ao=Object.keys(ea);ea.all=!0;function ha(e){const t={};for(const a of Ao)e[a]===!0&&(t[a]=!0);return Object.keys(t).length===0?ea:(t.horizontal===!0?t.left=t.right=!0:t.left===!0&&t.right===!0&&(t.horizontal=!0),t.vertical===!0?t.up=t.down=!0:t.up===!0&&t.down===!0&&(t.vertical=!0),t.horizontal===!0&&t.vertical===!0&&(t.all=!0),t)}const xo=["INPUT","TEXTAREA"];function ya(e,t){return t.event===void 0&&e.target!==void 0&&e.target.draggable!==!0&&typeof t.handler=="function"&&xo.includes(e.target.nodeName.toUpperCase())===!1&&(e.qClonedBy===void 0||e.qClonedBy.indexOf(t.uid)===-1)}function Ro(e){const t=[.06,6,50];return typeof e=="string"&&e.length&&e.split(":").forEach((a,n)=>{const s=parseFloat(a);s&&(t[n]=s)}),t}const Eo=_n({name:"touch-swipe",beforeMount(e,{value:t,arg:a,modifiers:n}){if(n.mouse!==!0&&pe.has.touch!==!0)return;const s=n.mouseCapture===!0?"Capture":"",o={handler:t,sensitivity:Ro(a),direction:ha(n),noop:Tn,mouseStart(r){ya(r,o)&&Cn(r)&&(Ue(o,"temp",[[document,"mousemove","move",`notPassive${s}`],[document,"mouseup","end","notPassiveCapture"]]),o.start(r,!0))},touchStart(r){if(ya(r,o)){const l=r.target;Ue(o,"temp",[[l,"touchmove","move","notPassiveCapture"],[l,"touchcancel","end","notPassiveCapture"],[l,"touchend","end","notPassiveCapture"]]),o.start(r)}},start(r,l){pe.is.firefox===!0&&It(e,!0);const d=ia(r);o.event={x:d.left,y:d.top,time:Date.now(),mouse:l===!0,dir:!1}},move(r){if(o.event===void 0)return;if(o.event.dir!==!1){Be(r);return}const l=Date.now()-o.event.time;if(l===0)return;const d=ia(r),c=d.left-o.event.x,w=Math.abs(c),T=d.top-o.event.y,y=Math.abs(T);if(o.event.mouse!==!0){if(w<o.sensitivity[1]&&y<o.sensitivity[1]){o.end(r);return}}else if(window.getSelection().toString()!==""){o.end(r);return}else if(w<o.sensitivity[2]&&y<o.sensitivity[2])return;const A=w/l,I=y/l;o.direction.vertical===!0&&w<y&&w<100&&I>o.sensitivity[0]&&(o.event.dir=T<0?"up":"down"),o.direction.horizontal===!0&&w>y&&y<100&&A>o.sensitivity[0]&&(o.event.dir=c<0?"left":"right"),o.direction.up===!0&&w<y&&T<0&&w<100&&I>o.sensitivity[0]&&(o.event.dir="up"),o.direction.down===!0&&w<y&&T>0&&w<100&&I>o.sensitivity[0]&&(o.event.dir="down"),o.direction.left===!0&&w>y&&c<0&&y<100&&A>o.sensitivity[0]&&(o.event.dir="left"),o.direction.right===!0&&w>y&&c>0&&y<100&&A>o.sensitivity[0]&&(o.event.dir="right"),o.event.dir!==!1?(Be(r),o.event.mouse===!0&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),jt(),o.styleCleanup=$=>{o.styleCleanup=void 0,document.body.classList.remove("non-selectable");const k=()=>{document.body.classList.remove("no-pointer-events--children")};$===!0?setTimeout(k,50):k()}),o.handler({evt:r,touch:o.event.mouse!==!0,mouse:o.event.mouse,direction:o.event.dir,duration:l,distance:{x:w,y}})):o.end(r)},end(r){o.event!==void 0&&(at(o,"temp"),pe.is.firefox===!0&&It(e,!1),o.styleCleanup?.(!0),r!==void 0&&o.event.dir!==!1&&Be(r),o.event=void 0)}};if(e.__qtouchswipe=o,n.mouse===!0){const r=n.mouseCapture===!0||n.mousecapture===!0?"Capture":"";Ue(o,"main",[[e,"mousedown","mouseStart",`passive${r}`]])}pe.has.touch===!0&&Ue(o,"main",[[e,"touchstart","touchStart",`passive${n.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,t){const a=e.__qtouchswipe;a!==void 0&&(t.oldValue!==t.value&&(typeof t.value!="function"&&a.end(),a.handler=t.value),a.direction=ha(t.modifiers))},beforeUnmount(e){const t=e.__qtouchswipe;t!==void 0&&(at(t,"main"),at(t,"temp"),pe.is.firefox===!0&&It(e,!1),t.styleCleanup?.(),delete e.__qtouchswipe)}});function Po(){let e=Object.create(null);return{getCache:(t,a)=>e[t]===void 0?e[t]=typeof a=="function"?a():a:e[t],setCache(t,a){e[t]=a},hasCache(t){return Object.hasOwnProperty.call(e,t)},clearCache(t){t!==void 0?delete e[t]:e=Object.create(null)}}}const Io={name:{required:!0},disable:Boolean},ba={setup(e,{slots:t}){return()=>L("div",{class:"q-panel scroll",role:"tabpanel"},fe(t.default))}},qo={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},Oo=["update:modelValue","beforeTransition","transition"];function Mo(){const{props:e,emit:t,proxy:a}=ge(),{getCache:n}=Po(),{registerTimeout:s}=st();let o,r;const l=B(null),d={value:null};function c(u){const i=e.vertical===!0?"up":"left";q((a.$q.lang.rtl===!0?-1:1)*(u.direction===i?1:-1))}const w=O(()=>[[Eo,c,void 0,{horizontal:e.vertical!==!0,vertical:e.vertical,mouse:!0}]]),T=O(()=>e.transitionPrev||`slide-${e.vertical===!0?"down":"right"}`),y=O(()=>e.transitionNext||`slide-${e.vertical===!0?"up":"left"}`),A=O(()=>`--q-transition-duration: ${e.transitionDuration}ms`),I=O(()=>typeof e.modelValue=="string"||typeof e.modelValue=="number"?e.modelValue:String(e.modelValue)),$=O(()=>({include:e.keepAliveInclude,exclude:e.keepAliveExclude,max:e.keepAliveMax})),k=O(()=>e.keepAliveInclude!==void 0||e.keepAliveExclude!==void 0);J(()=>e.modelValue,(u,i)=>{const _=v(u)===!0?C(u):-1;r!==!0&&x(_===-1?0:_<C(i)?-1:1),d.value!==_&&(d.value=_,t("beforeTransition",u,i),s(()=>{t("transition",u,i)},e.transitionDuration))});function N(){q(1)}function Q(){q(-1)}function M(u){t("update:modelValue",u)}function v(u){return u!=null&&u!==""}function C(u){return o.findIndex(i=>i.props.name===u&&i.props.disable!==""&&i.props.disable!==!0)}function f(){return o.filter(u=>u.props.disable!==""&&u.props.disable!==!0)}function x(u){const i=u!==0&&e.animated===!0&&d.value!==-1?"q-transition--"+(u===-1?T.value:y.value):null;l.value!==i&&(l.value=i)}function q(u,i=d.value){let _=i+u;for(;_!==-1&&_<o.length;){const E=o[_];if(E!==void 0&&E.props.disable!==""&&E.props.disable!==!0){x(u),r=!0,t("update:modelValue",E.props.name),setTimeout(()=>{r=!1});return}_+=u}e.infinite===!0&&o.length!==0&&i!==-1&&i!==o.length&&q(u,u===-1?o.length:-1)}function z(){const u=C(e.modelValue);return d.value!==u&&(d.value=u),!0}function m(){const u=v(e.modelValue)===!0&&z()&&o[d.value];return e.keepAlive===!0?[L(kn,$.value,[L(k.value===!0?n(I.value,()=>({...ba,name:I.value})):ba,{key:I.value,style:A.value},()=>u)])]:[L("div",{class:"q-panel scroll",style:A.value,key:I.value,role:"tabpanel"},[u])]}function g(){if(o.length!==0)return e.animated===!0?[L(ot,{name:l.value},m)]:m()}function R(u){return o=Sn(fe(u.default,[])).filter(i=>i.props!==null&&i.props.slot===void 0&&v(i.props.name)===!0),o.length}function S(){return o}return Object.assign(a,{next:N,previous:Q,goTo:M}),{panelIndex:d,panelDirectives:w,updatePanelsList:R,updatePanelIndex:z,getPanelContent:g,getEnabledPanels:f,getPanels:S,isValidPanelName:v,keepAliveProps:$,needsUniqueKeepAliveWrapper:k,goToPanelByOffset:q,goToPanel:M,nextPanel:N,previousPanel:Q}}const Ot=ve({name:"QTabPanel",props:Io,setup(e,{slots:t}){return()=>L("div",{class:"q-tab-panel",role:"tabpanel"},fe(t.default))}}),$o=ve({name:"QTabPanels",props:{...qo,...Yt},emits:Oo,setup(e,{slots:t}){const a=ge(),n=Zt(e,a.proxy.$q),{updatePanelsList:s,getPanelContent:o,panelDirectives:r}=Mo(),l=O(()=>"q-tab-panels q-panel-parent"+(n.value===!0?" q-tab-panels--dark q-dark":""));return()=>(s(t),An("div",{class:l.value},o(),"pan",e.swipeable,()=>r.value))}}),Lo=ve({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:t}){const{proxy:{$q:a}}=ge(),n=wt(xn,Ae);if(n===Ae)return console.error("QPage needs to be a deep child of QLayout"),Ae;if(wt(Rn,Ae)===Ae)return console.error("QPage needs to be child of QPageContainer"),Ae;const o=O(()=>{const l=(n.header.space===!0?n.header.size:0)+(n.footer.space===!0?n.footer.size:0);if(typeof e.styleFn=="function"){const d=n.isContainer.value===!0?n.containerHeight.value:a.screen.height;return e.styleFn(l,d)}return{minHeight:n.isContainer.value===!0?n.containerHeight.value-l+"px":a.screen.height===0?l!==0?`calc(100vh - ${l}px)`:"100vh":a.screen.height-l+"px"}}),r=O(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>L("main",{class:r.value,style:o.value},fe(t.default))}}),Fo=()=>L("div",{key:"svg",class:"q-checkbox__bg absolute"},[L("svg",{class:"q-checkbox__svg fit absolute-full",viewBox:"0 0 24 24"},[L("path",{class:"q-checkbox__truthy",fill:"none",d:"M1.73,12.91 8.1,19.28 22.79,4.59"}),L("path",{class:"q-checkbox__indet",d:"M4,14H20V10H4"})])]),Vo=ve({name:"QCheckbox",props:Zn,emits:Yn,setup(e){const t=Fo();function a(n,s){const o=O(()=>(n.value===!0?e.checkedIcon:s.value===!0?e.indeterminateIcon:e.uncheckedIcon)||null);return()=>o.value!==null?[L("div",{key:"icon",class:"q-checkbox__icon-container absolute-full flex flex-center no-wrap"},[L(Te,{class:"q-checkbox__icon",name:o.value})])]:[t]}return Xn("checkbox",a)}}),Bo=ve({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(e,{slots:t}){const a=O(()=>`q-card__section q-card__section--${e.horizontal===!0?"horiz row no-wrap":"vert"}`);return()=>L(e.tag,{class:a.value},fe(t.default))}}),Do=ve({name:"QCardActions",props:{...En,vertical:Boolean},setup(e,{slots:t}){const a=Pn(e),n=O(()=>`q-card__actions ${a.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>L("div",{class:n.value},fe(t.default))}}),zo=ve({name:"QCard",props:{...Yt,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(e,{slots:t}){const{proxy:{$q:a}}=ge(),n=Zt(e,a),s=O(()=>"q-card"+(n.value===!0?" q-card--dark q-dark":"")+(e.bordered===!0?" q-card--bordered":"")+(e.square===!0?" q-card--square no-border-radius":"")+(e.flat===!0?" q-card--flat no-shadow":""));return()=>L(e.tag,{class:s.value},fe(t.default))}});function No(e,t,a){let n;function s(){n!==void 0&&(ua.remove(n),n=void 0)}return Ce(()=>{e.value===!0&&s()}),{removeFromHistory:s,addToHistory(){n={condition:()=>a.value===!0,handler:t},ua.add(n)}}}let Ze=0,Mt,$t,et,Lt=!1,wa,_a,Ta,Me=null;function Uo(e){Ho(e)&&Be(e)}function Ho(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=In(e),a=e.shiftKey&&!e.deltaX,n=!a&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),s=a||n?e.deltaY:e.deltaX;for(let o=0;o<t.length;o++){const r=t[o];if(to(r,n))return n?s<0&&r.scrollTop===0?!0:s>0&&r.scrollTop+r.clientHeight===r.scrollHeight:s<0&&r.scrollLeft===0?!0:s>0&&r.scrollLeft+r.clientWidth===r.scrollWidth}return!0}function Ca(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function dt(e){Lt!==!0&&(Lt=!0,requestAnimationFrame(()=>{Lt=!1;const{height:t}=e.target,{clientHeight:a,scrollTop:n}=document.scrollingElement;(et===void 0||t!==window.innerHeight)&&(et=a-t,document.scrollingElement.scrollTop=n),n>et&&(document.scrollingElement.scrollTop-=Math.ceil((n-et)/8))}))}function Sa(e){const t=document.body,a=window.visualViewport!==void 0;if(e==="add"){const{overflowY:n,overflowX:s}=window.getComputedStyle(t);Mt=Jn(window),$t=eo(window),wa=t.style.left,_a=t.style.top,Ta=window.location.href,t.style.left=`-${Mt}px`,t.style.top=`-${$t}px`,s!=="hidden"&&(s==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),n!=="hidden"&&(n==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,pe.is.ios===!0&&(a===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",dt,Oe.passiveCapture),window.visualViewport.addEventListener("scroll",dt,Oe.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",Ca,Oe.passiveCapture))}pe.is.desktop===!0&&pe.is.mac===!0&&window[`${e}EventListener`]("wheel",Uo,Oe.notPassive),e==="remove"&&(pe.is.ios===!0&&(a===!0?(window.visualViewport.removeEventListener("resize",dt,Oe.passiveCapture),window.visualViewport.removeEventListener("scroll",dt,Oe.passiveCapture)):window.removeEventListener("scroll",Ca,Oe.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=wa,t.style.top=_a,window.location.href===Ta&&window.scrollTo(Mt,$t),et=void 0)}function jo(e){let t="add";if(e===!0){if(Ze++,Me!==null){clearTimeout(Me),Me=null;return}if(Ze>1)return}else{if(Ze===0||(Ze--,Ze>0))return;if(t="remove",pe.is.ios===!0&&pe.is.nativeMobile===!0){Me!==null&&clearTimeout(Me),Me=setTimeout(()=>{Sa(t),Me=null},100);return}}Sa(t)}function Ko(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,jo(t))}}}let ft=0;const Qo={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},ka={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]},Wo=ve({name:"QDialog",inheritAttrs:!1,props:{...za,...vt,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,backdropFilter:String,position:{type:String,default:"standard",validator:e=>["standard","top","bottom","left","right"].includes(e)}},emits:[...Da,"shake","click","escapeKey"],setup(e,{slots:t,emit:a,attrs:n}){const s=ge(),o=B(null),r=B(!1),l=B(!1);let d=null,c=null,w,T;const y=O(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:A}=Ko(),{registerTimeout:I}=st(),{registerTick:$,removeTick:k}=nt(),{transitionProps:N,transitionStyle:Q}=Na(e,()=>ka[e.position][0],()=>ka[e.position][1]),M=O(()=>Q.value+(e.backdropFilter!==void 0?`;backdrop-filter:${e.backdropFilter};-webkit-backdrop-filter:${e.backdropFilter}`:"")),{showPortal:v,hidePortal:C,portalIsAccessible:f,renderPortal:x}=Ha(s,o,ne,"dialog"),{hide:q}=Ua({showing:r,hideOnRouteChange:y,handleShow:i,handleHide:_,processOnMount:!0}),{addToHistory:z,removeFromHistory:m}=No(r,q,y),g=O(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${Qo[e.position]}`+(l.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),R=O(()=>r.value===!0&&e.seamless!==!0),S=O(()=>e.autoClose===!0?{onClick:b}:{}),u=O(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${R.value===!0?"modal":"seamless"}`,n.class]);J(()=>e.maximized,D=>{r.value===!0&&j(D)}),J(R,D=>{A(D),D===!0?(ao(ee),no(F)):(ma(ee),pa(F))});function i(D){z(),c=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,j(e.maximized),v(),l.value=!0,e.noFocus!==!0?(document.activeElement?.blur(),$(E)):k(),I(()=>{if(s.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:G,bottom:me}=document.activeElement.getBoundingClientRect(),{innerHeight:lt}=window,ze=window.visualViewport!==void 0?window.visualViewport.height:lt;G>0&&me>ze/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-ze,me>=lt?1/0:Math.ceil(document.scrollingElement.scrollTop+me-ze/2))),document.activeElement.scrollIntoView()}T=!0,o.value.click(),T=!1}v(!0),l.value=!1,a("show",D)},e.transitionDuration)}function _(D){k(),m(),le(!0),l.value=!0,C(),c!==null&&(((D?.type.indexOf("key")===0?c.closest('[tabindex]:not([tabindex^="-"])'):void 0)||c).focus(),c=null),I(()=>{C(!0),l.value=!1,a("hide",D)},e.transitionDuration)}function E(D){Xt(()=>{let G=o.value;if(G!==null){if(D!==void 0){const me=G.querySelector(D);if(me!==null){me.focus({preventScroll:!0});return}}G.contains(document.activeElement)!==!0&&(G=G.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||G.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||G.querySelector("[autofocus], [data-autofocus]")||G,G.focus({preventScroll:!0}))}})}function h(D){D&&typeof D.focus=="function"?D.focus({preventScroll:!0}):E(),a("shake");const G=o.value;G!==null&&(G.classList.remove("q-animate--scale"),G.classList.add("q-animate--scale"),d!==null&&clearTimeout(d),d=setTimeout(()=>{d=null,o.value!==null&&(G.classList.remove("q-animate--scale"),E())},170))}function F(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&h():(a("escapeKey"),q()))}function le(D){d!==null&&(clearTimeout(d),d=null),(D===!0||r.value===!0)&&(j(!1),e.seamless!==!0&&(A(!1),ma(ee),pa(F))),D!==!0&&(c=null)}function j(D){D===!0?w!==!0&&(ft<1&&document.body.classList.add("q-body--dialog"),ft++,w=!0):w===!0&&(ft<2&&document.body.classList.remove("q-body--dialog"),ft--,w=!1)}function b(D){T!==!0&&(q(D),a("click",D))}function U(D){e.persistent!==!0&&e.noBackdropDismiss!==!0?q(D):e.noShake!==!0&&h()}function ee(D){e.allowFocusOutside!==!0&&f.value===!0&&qn(o.value,D.target)!==!0&&E('[tabindex]:not([tabindex="-1"])')}Object.assign(s.proxy,{focus:E,shake:h,__updateRefocusTarget(D){c=D||null}}),Ce(le);function ne(){return L("div",{role:"dialog","aria-modal":R.value===!0?"true":"false",...n,class:u.value},[L(ot,{name:"q-transition--fade",appear:!0},()=>R.value===!0?L("div",{class:"q-dialog__backdrop fixed-full",style:M.value,"aria-hidden":"true",tabindex:-1,onClick:U}):null),L(ot,N.value,()=>r.value===!0?L("div",{ref:o,class:g.value,style:Q.value,tabindex:-1,...S.value},fe(t.default)):null)])}return x}}),Aa=/^on[A-Z]/;function Go(){const{attrs:e,vnode:t}=ge(),a={listeners:B({}),attributes:B({})};function n(){const s={},o={};for(const r in e)r!=="class"&&r!=="style"&&Aa.test(r)===!1&&(s[r]=e[r]);for(const r in t.props)Aa.test(r)===!0&&(o[r]=t.props[r]);a.attributes.value=s,a.listeners.value=o}return On(n),n(),a}function Yo({validate:e,resetValidation:t,requiresQForm:a}){const n=wt(Mn,!1);if(n!==!1){const{props:s,proxy:o}=ge();Object.assign(o,{validate:e,resetValidation:t}),J(()=>s.disable,r=>{r===!0?(typeof t=="function"&&t(),n.unbindComponent(o)):n.bindComponent(o)}),Qe(()=>{s.disable!==!0&&n.bindComponent(o)}),Ce(()=>{s.disable!==!0&&n.unbindComponent(o)})}else a===!0&&console.error("Parent QForm not found on useFormChild()!")}const xa=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,Ra=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,Ea=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,gt=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,mt=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,Ft={date:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e),time:e=>/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(e),fulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(e),timeOrFulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/.test(e),email:e=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e),hexColor:e=>xa.test(e),hexaColor:e=>Ra.test(e),hexOrHexaColor:e=>Ea.test(e),rgbColor:e=>gt.test(e),rgbaColor:e=>mt.test(e),rgbOrRgbaColor:e=>gt.test(e)||mt.test(e),hexOrRgbColor:e=>xa.test(e)||gt.test(e),hexaOrRgbaColor:e=>Ra.test(e)||mt.test(e),anyColor:e=>Ea.test(e)||gt.test(e)||mt.test(e)},Zo=[!0,!1,"ondemand"],Xo={modelValue:{},error:{type:Boolean,default:null},errorMessage:String,noErrorIcon:Boolean,rules:Array,reactiveRules:Boolean,lazyRules:{type:[Boolean,String],default:!1,validator:e=>Zo.includes(e)}};function Jo(e,t){const{props:a,proxy:n}=ge(),s=B(!1),o=B(null),r=B(!1);Yo({validate:$,resetValidation:I});let l=0,d;const c=O(()=>a.rules!==void 0&&a.rules!==null&&a.rules.length!==0),w=O(()=>a.disable!==!0&&c.value===!0&&t.value===!1),T=O(()=>a.error===!0||s.value===!0),y=O(()=>typeof a.errorMessage=="string"&&a.errorMessage.length!==0?a.errorMessage:o.value);J(()=>a.modelValue,()=>{r.value=!0,w.value===!0&&a.lazyRules===!1&&k()});function A(){a.lazyRules!=="ondemand"&&w.value===!0&&r.value===!0&&k()}J(()=>a.reactiveRules,N=>{N===!0?d===void 0&&(d=J(()=>a.rules,A,{immediate:!0,deep:!0})):d!==void 0&&(d(),d=void 0)},{immediate:!0}),J(()=>a.lazyRules,A),J(e,N=>{N===!0?r.value=!0:w.value===!0&&a.lazyRules!=="ondemand"&&k()});function I(){l++,t.value=!1,r.value=!1,s.value=!1,o.value=null,k.cancel()}function $(N=a.modelValue){if(a.disable===!0||c.value===!1)return!0;const Q=++l,M=t.value!==!0?()=>{r.value=!0}:()=>{},v=(f,x)=>{f===!0&&M(),s.value=f,o.value=x||null,t.value=!1},C=[];for(let f=0;f<a.rules.length;f++){const x=a.rules[f];let q;if(typeof x=="function"?q=x(N,Ft):typeof x=="string"&&Ft[x]!==void 0&&(q=Ft[x](N)),q===!1||typeof q=="string")return v(!0,q),!1;q!==!0&&q!==void 0&&C.push(q)}return C.length===0?(v(!1),!0):(t.value=!0,Promise.all(C).then(f=>{if(f===void 0||Array.isArray(f)===!1||f.length===0)return Q===l&&v(!1),!0;const x=f.find(q=>q===!1||typeof q=="string");return Q===l&&v(x!==void 0,x),x===void 0},f=>(Q===l&&(console.error(f),v(!0)),!1)))}const k=$n($,0);return Ce(()=>{d?.(),k.cancel()}),Object.assign(n,{resetValidation:I,validate:$}),Ba(n,"hasError",()=>T.value),{isDirtyModel:r,hasRules:c,hasError:T,errorMessage:y,validate:$,resetValidation:I}}function Qt(e){return e!=null&&(""+e).length!==0}const es={...Yt,...Xo,label:String,stackLabel:Boolean,hint:String,hideHint:Boolean,prefix:String,suffix:String,labelColor:String,color:String,bgColor:String,filled:Boolean,outlined:Boolean,borderless:Boolean,standout:[Boolean,String],square:Boolean,loading:Boolean,labelSlot:Boolean,bottomSlots:Boolean,hideBottomSpace:Boolean,rounded:Boolean,dense:Boolean,itemAligned:Boolean,counter:Boolean,clearable:Boolean,clearIcon:String,disable:Boolean,readonly:Boolean,autofocus:Boolean,for:String},ts={...es,maxlength:[Number,String]},as=["update:modelValue","clear","focus","blur"];function ns({requiredForAttr:e=!0,tagProp:t,changeEvent:a=!1}={}){const{props:n,proxy:s}=ge(),o=Zt(n,s.$q),r=oo({required:e,getValue:()=>n.for});return{requiredForAttr:e,changeEvent:a,tag:t===!0?O(()=>n.tag):{value:"label"},isDark:o,editable:O(()=>n.disable!==!0&&n.readonly!==!0),innerLoading:B(!1),focused:B(!1),hasPopupOpen:!1,splitAttrs:Go(),targetUid:r,rootRef:B(null),targetRef:B(null),controlRef:B(null)}}function os(e){const{props:t,emit:a,slots:n,attrs:s,proxy:o}=ge(),{$q:r}=o;let l=null;e.hasValue===void 0&&(e.hasValue=O(()=>Qt(t.modelValue))),e.emitValue===void 0&&(e.emitValue=h=>{a("update:modelValue",h)}),e.controlEvents===void 0&&(e.controlEvents={onFocusin:z,onFocusout:m}),Object.assign(e,{clearValue:g,onControlFocusin:z,onControlFocusout:m,focus:x}),e.computedCounter===void 0&&(e.computedCounter=O(()=>{if(t.counter!==!1){const h=typeof t.modelValue=="string"||typeof t.modelValue=="number"?(""+t.modelValue).length:Array.isArray(t.modelValue)===!0?t.modelValue.length:0,F=t.maxlength!==void 0?t.maxlength:t.maxValues;return h+(F!==void 0?" / "+F:"")}}));const{isDirtyModel:d,hasRules:c,hasError:w,errorMessage:T,resetValidation:y}=Jo(e.focused,e.innerLoading),A=e.floatingLabel!==void 0?O(()=>t.stackLabel===!0||e.focused.value===!0||e.floatingLabel.value===!0):O(()=>t.stackLabel===!0||e.focused.value===!0||e.hasValue.value===!0),I=O(()=>t.bottomSlots===!0||t.hint!==void 0||c.value===!0||t.counter===!0||t.error!==null),$=O(()=>t.filled===!0?"filled":t.outlined===!0?"outlined":t.borderless===!0?"borderless":t.standout?"standout":"standard"),k=O(()=>`q-field row no-wrap items-start q-field--${$.value}`+(e.fieldClass!==void 0?` ${e.fieldClass.value}`:"")+(t.rounded===!0?" q-field--rounded":"")+(t.square===!0?" q-field--square":"")+(A.value===!0?" q-field--float":"")+(Q.value===!0?" q-field--labeled":"")+(t.dense===!0?" q-field--dense":"")+(t.itemAligned===!0?" q-field--item-aligned q-item-type":"")+(e.isDark.value===!0?" q-field--dark":"")+(e.getControl===void 0?" q-field--auto-height":"")+(e.focused.value===!0?" q-field--focused":"")+(w.value===!0?" q-field--error":"")+(w.value===!0||e.focused.value===!0?" q-field--highlighted":"")+(t.hideBottomSpace!==!0&&I.value===!0?" q-field--with-bottom":"")+(t.disable===!0?" q-field--disabled":t.readonly===!0?" q-field--readonly":"")),N=O(()=>"q-field__control relative-position row no-wrap"+(t.bgColor!==void 0?` bg-${t.bgColor}`:"")+(w.value===!0?" text-negative":typeof t.standout=="string"&&t.standout.length!==0&&e.focused.value===!0?` ${t.standout}`:t.color!==void 0?` text-${t.color}`:"")),Q=O(()=>t.labelSlot===!0||t.label!==void 0),M=O(()=>"q-field__label no-pointer-events absolute ellipsis"+(t.labelColor!==void 0&&w.value!==!0?` text-${t.labelColor}`:"")),v=O(()=>({id:e.targetUid.value,editable:e.editable.value,focused:e.focused.value,floatingLabel:A.value,modelValue:t.modelValue,emitValue:e.emitValue})),C=O(()=>{const h={};return e.targetUid.value&&(h.for=e.targetUid.value),t.disable===!0&&(h["aria-disabled"]="true"),h});function f(){const h=document.activeElement;let F=e.targetRef?.value;F&&(h===null||h.id!==e.targetUid.value)&&(F.hasAttribute("tabindex")===!0||(F=F.querySelector("[tabindex]")),F!==h&&F?.focus({preventScroll:!0}))}function x(){Xt(f)}function q(){so(f);const h=document.activeElement;h!==null&&e.rootRef.value.contains(h)&&h.blur()}function z(h){l!==null&&(clearTimeout(l),l=null),e.editable.value===!0&&e.focused.value===!1&&(e.focused.value=!0,a("focus",h))}function m(h,F){l!==null&&clearTimeout(l),l=setTimeout(()=>{l=null,!(document.hasFocus()===!0&&(e.hasPopupOpen===!0||e.controlRef===void 0||e.controlRef.value===null||e.controlRef.value.contains(document.activeElement)!==!1))&&(e.focused.value===!0&&(e.focused.value=!1,a("blur",h)),F?.())})}function g(h){Be(h),r.platform.is.mobile!==!0?(e.targetRef?.value||e.rootRef.value).focus():e.rootRef.value.contains(document.activeElement)===!0&&document.activeElement.blur(),t.type==="file"&&(e.inputRef.value.value=null),a("update:modelValue",null),e.changeEvent===!0&&a("change",null),a("clear",t.modelValue),Fe(()=>{const F=d.value;y(),d.value=F})}function R(h){[13,32].includes(h.keyCode)&&g(h)}function S(){const h=[];return n.prepend!==void 0&&h.push(L("div",{class:"q-field__prepend q-field__marginal row no-wrap items-center",key:"prepend",onClick:Ge},n.prepend())),h.push(L("div",{class:"q-field__control-container col relative-position row no-wrap q-anchor--skip"},u())),w.value===!0&&t.noErrorIcon===!1&&h.push(_("error",[L(Te,{name:r.iconSet.field.error,color:"negative"})])),t.loading===!0||e.innerLoading.value===!0?h.push(_("inner-loading-append",n.loading!==void 0?n.loading():[L(Ln,{color:t.color})])):t.clearable===!0&&e.hasValue.value===!0&&e.editable.value===!0&&h.push(_("inner-clearable-append",[L(Te,{class:"q-field__focusable-action",name:t.clearIcon||r.iconSet.field.clear,tabindex:0,role:"button","aria-hidden":"false","aria-label":r.lang.label.clear,onKeyup:R,onClick:g})])),n.append!==void 0&&h.push(L("div",{class:"q-field__append q-field__marginal row no-wrap items-center",key:"append",onClick:Ge},n.append())),e.getInnerAppend!==void 0&&h.push(_("inner-append",e.getInnerAppend())),e.getControlChild!==void 0&&h.push(e.getControlChild()),h}function u(){const h=[];return t.prefix!==void 0&&t.prefix!==null&&h.push(L("div",{class:"q-field__prefix no-pointer-events row items-center"},t.prefix)),e.getShadowControl!==void 0&&e.hasShadow.value===!0&&h.push(e.getShadowControl()),Q.value===!0&&h.push(L("div",{class:M.value},fe(n.label,t.label))),e.getControl!==void 0?h.push(e.getControl()):n.rawControl!==void 0?h.push(n.rawControl()):n.control!==void 0&&h.push(L("div",{ref:e.targetRef,class:"q-field__native row",tabindex:-1,...e.splitAttrs.attributes.value,"data-autofocus":t.autofocus===!0||void 0},n.control(v.value))),t.suffix!==void 0&&t.suffix!==null&&h.push(L("div",{class:"q-field__suffix no-pointer-events row items-center"},t.suffix)),h.concat(fe(n.default))}function i(){let h,F;w.value===!0?T.value!==null?(h=[L("div",{role:"alert"},T.value)],F=`q--slot-error-${T.value}`):(h=fe(n.error),F="q--slot-error"):(t.hideHint!==!0||e.focused.value===!0)&&(t.hint!==void 0?(h=[L("div",t.hint)],F=`q--slot-hint-${t.hint}`):(h=fe(n.hint),F="q--slot-hint"));const le=t.counter===!0||n.counter!==void 0;if(t.hideBottomSpace===!0&&le===!1&&h===void 0)return;const j=L("div",{key:F,class:"q-field__messages col"},h);return L("div",{class:"q-field__bottom row items-start q-field__bottom--"+(t.hideBottomSpace!==!0?"animated":"stale"),onClick:Ge},[t.hideBottomSpace===!0?j:L(ot,{name:"q-transition--field-message"},()=>j),le===!0?L("div",{class:"q-field__counter"},n.counter!==void 0?n.counter():e.computedCounter.value):null])}function _(h,F){return F===null?null:L("div",{key:h,class:"q-field__append q-field__marginal row no-wrap items-center q-anchor--skip"},F)}let E=!1;return Fa(()=>{E=!0}),Va(()=>{E===!0&&t.autofocus===!0&&o.focus()}),t.autofocus===!0&&Qe(()=>{o.focus()}),Ce(()=>{l!==null&&clearTimeout(l)}),Object.assign(o,{focus:x,blur:q}),function(){const F=e.getControl===void 0&&n.control===void 0?{...e.splitAttrs.attributes.value,"data-autofocus":t.autofocus===!0||void 0,...C.value}:C.value;return L(e.tag.value,{ref:e.rootRef,class:[k.value,s.class],style:s.style,...F},[n.before!==void 0?L("div",{class:"q-field__before q-field__marginal row no-wrap items-center",onClick:Ge},n.before()):null,L("div",{class:"q-field__inner relative-position col self-stretch"},[L("div",{ref:e.controlRef,class:N.value,tabindex:-1,...e.controlEvents},S()),I.value===!0?i():null]),n.after!==void 0?L("div",{class:"q-field__after q-field__marginal row no-wrap items-center",onClick:Ge},n.after()):null])}}const Pa={date:"####/##/##",datetime:"####/##/## ##:##",time:"##:##",fulltime:"##:##:##",phone:"(###) ### - ####",card:"#### #### #### ####"},{tokenMap:Ia,tokenKeys:ss}=Ka({"#":{pattern:"[\\d]",negate:"[^\\d]"},S:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]"},N:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]"},A:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleUpperCase()},a:{pattern:"[a-zA-Z]",negate:"[^a-zA-Z]",transform:e=>e.toLocaleLowerCase()},X:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleUpperCase()},x:{pattern:"[0-9a-zA-Z]",negate:"[^0-9a-zA-Z]",transform:e=>e.toLocaleLowerCase()}});function Ka(e){const t=Object.keys(e),a={};return t.forEach(n=>{const s=e[n];a[n]={...s,regex:new RegExp(s.pattern)}}),{tokenMap:a,tokenKeys:t}}function Qa(e){return new RegExp("\\\\([^.*+?^${}()|([\\]])|([.*+?^${}()|[\\]])|(["+e.join("")+"])|(.)","g")}const qa=/[.*+?^${}()|[\]\\]/g,rs=Qa(ss),re="",ls={mask:String,reverseFillMask:Boolean,fillMask:[Boolean,String],unmaskedValue:Boolean,maskTokens:Object};function is(e,t,a,n){let s,o,r,l,d,c;const w=O(()=>{if(e.maskTokens===void 0||e.maskTokens===null)return{tokenMap:Ia,tokenRegexMask:rs};const{tokenMap:m}=Ka(e.maskTokens),g={...Ia,...m};return{tokenMap:g,tokenRegexMask:Qa(Object.keys(g))}}),T=B(null),y=B(I());function A(){return e.autogrow===!0||["textarea","text","search","url","tel","password"].includes(e.type)}J(()=>e.type+e.autogrow,k),J(()=>e.mask,m=>{if(m!==void 0)N(y.value,!0);else{const g=q(y.value);k(),e.modelValue!==g&&t("update:modelValue",g)}}),J(()=>e.fillMask+e.reverseFillMask,()=>{T.value===!0&&N(y.value,!0)}),J(()=>e.unmaskedValue,()=>{T.value===!0&&N(y.value)});function I(){if(k(),T.value===!0){const m=f(q(e.modelValue));return e.fillMask!==!1?z(m):m}return e.modelValue}function $(m){if(m<s.length)return s.slice(-m);let g="",R=s;const S=R.indexOf(re);if(S!==-1){for(let u=m-R.length;u>0;u--)g+=re;R=R.slice(0,S)+g+R.slice(S)}return R}function k(){if(T.value=e.mask!==void 0&&e.mask.length!==0&&A(),T.value===!1){l=void 0,s="",o="";return}const m=Pa[e.mask]===void 0?e.mask:Pa[e.mask],g=typeof e.fillMask=="string"&&e.fillMask.length!==0?e.fillMask.slice(0,1):"_",R=g.replace(qa,"\\$&"),S=[],u=[],i=[];let _=e.reverseFillMask===!0,E="",h="";m.replace(w.value.tokenRegexMask,(b,U,ee,ne,D)=>{if(ne!==void 0){const G=w.value.tokenMap[ne];i.push(G),h=G.negate,_===!0&&(u.push("(?:"+h+"+)?("+G.pattern+"+)?(?:"+h+"+)?("+G.pattern+"+)?"),_=!1),u.push("(?:"+h+"+)?("+G.pattern+")?")}else if(ee!==void 0)E="\\"+(ee==="\\"?"":ee),i.push(ee),S.push("([^"+E+"]+)?"+E+"?");else{const G=U!==void 0?U:D;E=G==="\\"?"\\\\\\\\":G.replace(qa,"\\\\$&"),i.push(G),S.push("([^"+E+"]+)?"+E+"?")}});const F=new RegExp("^"+S.join("")+"("+(E===""?".":"[^"+E+"]")+"+)?"+(E===""?"":"["+E+"]*")+"$"),le=u.length-1,j=u.map((b,U)=>U===0&&e.reverseFillMask===!0?new RegExp("^"+R+"*"+b):U===le?new RegExp("^"+b+"("+(h===""?".":h)+"+)?"+(e.reverseFillMask===!0?"$":R+"*")):new RegExp("^"+b));r=i,l=b=>{const U=F.exec(e.reverseFillMask===!0?b:b.slice(0,i.length+1));U!==null&&(b=U.slice(1).join(""));const ee=[],ne=j.length;for(let D=0,G=b;D<ne;D++){const me=j[D].exec(G);if(me===null)break;G=G.slice(me.shift().length),ee.push(...me)}return ee.length!==0?ee.join(""):b},s=i.map(b=>typeof b=="string"?b:re).join(""),o=s.split(re).join(g)}function N(m,g,R){const S=n.value,u=S.selectionEnd,i=S.value.length-u,_=q(m);g===!0&&k();const E=f(_,g),h=e.fillMask!==!1?z(E):E,F=y.value!==h;S.value!==h&&(S.value=h),F===!0&&(y.value=h),document.activeElement===S&&Fe(()=>{if(h===o){const j=e.reverseFillMask===!0?o.length:0;S.setSelectionRange(j,j,"forward");return}if(R==="insertFromPaste"&&e.reverseFillMask!==!0){const j=S.selectionEnd;let b=u-1;for(let U=d;U<=b&&U<j;U++)s[U]!==re&&b++;M.right(S,b);return}if(["deleteContentBackward","deleteContentForward"].indexOf(R)!==-1){const j=e.reverseFillMask===!0?u===0?h.length>E.length?1:0:Math.max(0,h.length-(h===o?0:Math.min(E.length,i)+1))+1:u;S.setSelectionRange(j,j,"forward");return}if(e.reverseFillMask===!0)if(F===!0){const j=Math.max(0,h.length-(h===o?0:Math.min(E.length,i+1)));j===1&&u===1?S.setSelectionRange(j,j,"forward"):M.rightReverse(S,j)}else{const j=h.length-i;S.setSelectionRange(j,j,"backward")}else if(F===!0){const j=Math.max(0,s.indexOf(re),Math.min(E.length,u)-1);M.right(S,j)}else{const j=u-1;M.right(S,j)}});const le=e.unmaskedValue===!0?q(h):h;String(e.modelValue)!==le&&(e.modelValue!==null||le!=="")&&a(le,!0)}function Q(m,g,R){const S=f(q(m.value));g=Math.max(0,s.indexOf(re),Math.min(S.length,g)),d=g,m.setSelectionRange(g,R,"forward")}const M={left(m,g){const R=s.slice(g-1).indexOf(re)===-1;let S=Math.max(0,g-1);for(;S>=0;S--)if(s[S]===re){g=S,R===!0&&g++;break}if(S<0&&s[g]!==void 0&&s[g]!==re)return M.right(m,0);g>=0&&m.setSelectionRange(g,g,"backward")},right(m,g){const R=m.value.length;let S=Math.min(R,g+1);for(;S<=R;S++)if(s[S]===re){g=S;break}else s[S-1]===re&&(g=S);if(S>R&&s[g-1]!==void 0&&s[g-1]!==re)return M.left(m,R);m.setSelectionRange(g,g,"forward")},leftReverse(m,g){const R=$(m.value.length);let S=Math.max(0,g-1);for(;S>=0;S--)if(R[S-1]===re){g=S;break}else if(R[S]===re&&(g=S,S===0))break;if(S<0&&R[g]!==void 0&&R[g]!==re)return M.rightReverse(m,0);g>=0&&m.setSelectionRange(g,g,"backward")},rightReverse(m,g){const R=m.value.length,S=$(R),u=S.slice(0,g+1).indexOf(re)===-1;let i=Math.min(R,g+1);for(;i<=R;i++)if(S[i-1]===re){g=i,g>0&&u===!0&&g--;break}if(i>R&&S[g-1]!==void 0&&S[g-1]!==re)return M.leftReverse(m,R);m.setSelectionRange(g,g,"forward")}};function v(m){t("click",m),c=void 0}function C(m){if(t("keydown",m),La(m)===!0||m.altKey===!0)return;const g=n.value,R=g.selectionStart,S=g.selectionEnd;if(m.shiftKey||(c=void 0),m.keyCode===37||m.keyCode===39){m.shiftKey&&c===void 0&&(c=g.selectionDirection==="forward"?R:S);const u=M[(m.keyCode===39?"right":"left")+(e.reverseFillMask===!0?"Reverse":"")];if(m.preventDefault(),u(g,c===R?S:R),m.shiftKey){const i=g.selectionStart;g.setSelectionRange(Math.min(c,i),Math.max(c,i),"forward")}}else m.keyCode===8&&e.reverseFillMask!==!0&&R===S?(M.left(g,R),g.setSelectionRange(g.selectionStart,S,"backward")):m.keyCode===46&&e.reverseFillMask===!0&&R===S&&(M.rightReverse(g,S),g.setSelectionRange(R,g.selectionEnd,"forward"))}function f(m,g){if(m==null||m==="")return"";if(e.reverseFillMask===!0)return x(m,g);const R=r;let S=0,u="";for(let i=0;i<R.length;i++){const _=m[S],E=R[i];if(typeof E=="string")u+=E,g===!0&&_===E&&S++;else if(_!==void 0&&E.regex.test(_))u+=E.transform!==void 0?E.transform(_):_,S++;else return u}return u}function x(m,g){const R=r,S=s.indexOf(re);let u=m.length-1,i="";for(let _=R.length-1;_>=0&&u!==-1;_--){const E=R[_];let h=m[u];if(typeof E=="string")i=E+i,g===!0&&h===E&&u--;else if(h!==void 0&&E.regex.test(h))do i=(E.transform!==void 0?E.transform(h):h)+i,u--,h=m[u];while(S===_&&h!==void 0&&E.regex.test(h));else return i}return i}function q(m){return typeof m!="string"||l===void 0?typeof m=="number"?l(""+m):m:l(m)}function z(m){return o.length-m.length<=0?m:e.reverseFillMask===!0&&m.length!==0?o.slice(0,-m.length)+m:m+o.slice(m.length)}return{innerValue:y,hasMask:T,moveCursorForPaste:Q,updateMaskValue:N,onMaskedKeydown:C,onMaskedClick:v}}function us(e,t){function a(){const n=e.modelValue;try{const s="DataTransfer"in window?new DataTransfer:"ClipboardEvent"in window?new ClipboardEvent("").clipboardData:void 0;return Object(n)===n&&("length"in n?Array.from(n):[n]).forEach(o=>{s.items.add(o)}),{files:s.files}}catch{return{files:void 0}}}return O(()=>{if(e.type==="file")return a()})}const cs=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/,ds=/[\u4e00-\u9fff\u3400-\u4dbf\u{20000}-\u{2a6df}\u{2a700}-\u{2b73f}\u{2b740}-\u{2b81f}\u{2b820}-\u{2ceaf}\uf900-\ufaff\u3300-\u33ff\ufe30-\ufe4f\uf900-\ufaff\u{2f800}-\u{2fa1f}]/u,fs=/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/,gs=/[a-z0-9_ -]$/i;function ms(e){return function(a){if(a.type==="compositionend"||a.type==="change"){if(a.target.qComposing!==!0)return;a.target.qComposing=!1,e(a)}else a.type==="compositionupdate"&&a.target.qComposing!==!0&&typeof a.data=="string"&&(pe.is.firefox===!0?gs.test(a.data)===!1:cs.test(a.data)===!0||ds.test(a.data)===!0||fs.test(a.data)===!0)===!0&&(a.target.qComposing=!0)}}const Vt=ve({name:"QInput",inheritAttrs:!1,props:{...ts,...ls,...ro,modelValue:[String,Number,FileList],shadowText:String,type:{type:String,default:"text"},debounce:[String,Number],autogrow:Boolean,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...as,"paste","change","keydown","click","animationend"],setup(e,{emit:t,attrs:a}){const{proxy:n}=ge(),{$q:s}=n,o={};let r=NaN,l,d,c=null,w;const T=B(null),y=lo(e),{innerValue:A,hasMask:I,moveCursorForPaste:$,updateMaskValue:k,onMaskedKeydown:N,onMaskedClick:Q}=is(e,t,_,T),M=us(e),v=O(()=>Qt(A.value)),C=ms(u),f=ns({changeEvent:!0}),x=O(()=>e.type==="textarea"||e.autogrow===!0),q=O(()=>x.value===!0||["text","search","url","tel","password"].includes(e.type)),z=O(()=>{const b={...f.splitAttrs.listeners.value,onInput:u,onPaste:S,onChange:h,onBlur:F,onFocus:ca};return b.onCompositionstart=b.onCompositionupdate=b.onCompositionend=C,I.value===!0&&(b.onKeydown=N,b.onClick=Q),e.autogrow===!0&&(b.onAnimationend=i),b}),m=O(()=>{const b={tabindex:0,"data-autofocus":e.autofocus===!0||void 0,rows:e.type==="textarea"?6:void 0,"aria-label":e.label,name:y.value,...f.splitAttrs.attributes.value,id:f.targetUid.value,maxlength:e.maxlength,disabled:e.disable===!0,readonly:e.readonly===!0};return x.value===!1&&(b.type=e.type),e.autogrow===!0&&(b.rows=1),b});J(()=>e.type,()=>{T.value&&(T.value.value=e.modelValue)}),J(()=>e.modelValue,b=>{if(I.value===!0){if(d===!0&&(d=!1,String(b)===r))return;k(b)}else A.value!==b&&(A.value=b,e.type==="number"&&o.hasOwnProperty("value")===!0&&(l===!0?l=!1:delete o.value));e.autogrow===!0&&Fe(E)}),J(()=>e.autogrow,b=>{b===!0?Fe(E):T.value!==null&&a.rows>0&&(T.value.style.height="auto")}),J(()=>e.dense,()=>{e.autogrow===!0&&Fe(E)});function g(){Xt(()=>{const b=document.activeElement;T.value!==null&&T.value!==b&&(b===null||b.id!==f.targetUid.value)&&T.value.focus({preventScroll:!0})})}function R(){T.value?.select()}function S(b){if(I.value===!0&&e.reverseFillMask!==!0){const U=b.target;$(U,U.selectionStart,U.selectionEnd)}t("paste",b)}function u(b){if(!b||!b.target)return;if(e.type==="file"){t("update:modelValue",b.target.files);return}const U=b.target.value;if(b.target.qComposing===!0){o.value=U;return}if(I.value===!0)k(U,!1,b.inputType);else if(_(U),q.value===!0&&b.target===document.activeElement){const{selectionStart:ee,selectionEnd:ne}=b.target;ee!==void 0&&ne!==void 0&&Fe(()=>{b.target===document.activeElement&&U.indexOf(b.target.value)===0&&b.target.setSelectionRange(ee,ne)})}e.autogrow===!0&&E()}function i(b){t("animationend",b),E()}function _(b,U){w=()=>{c=null,e.type!=="number"&&o.hasOwnProperty("value")===!0&&delete o.value,e.modelValue!==b&&r!==b&&(r=b,U===!0&&(d=!0),t("update:modelValue",b),Fe(()=>{r===b&&(r=NaN)})),w=void 0},e.type==="number"&&(l=!0,o.value=b),e.debounce!==void 0?(c!==null&&clearTimeout(c),o.value=b,c=setTimeout(w,e.debounce)):w()}function E(){requestAnimationFrame(()=>{const b=T.value;if(b!==null){const U=b.parentNode.style,{scrollTop:ee}=b,{overflowY:ne,maxHeight:D}=s.platform.is.firefox===!0?{}:window.getComputedStyle(b),G=ne!==void 0&&ne!=="scroll";G===!0&&(b.style.overflowY="hidden"),U.marginBottom=b.scrollHeight-1+"px",b.style.height="1px",b.style.height=b.scrollHeight+"px",G===!0&&(b.style.overflowY=parseInt(D,10)<b.scrollHeight?"auto":"hidden"),U.marginBottom="",b.scrollTop=ee}})}function h(b){C(b),c!==null&&(clearTimeout(c),c=null),w?.(),t("change",b.target.value)}function F(b){b!==void 0&&ca(b),c!==null&&(clearTimeout(c),c=null),w?.(),l=!1,d=!1,delete o.value,e.type!=="file"&&setTimeout(()=>{T.value!==null&&(T.value.value=A.value!==void 0?A.value:"")})}function le(){return o.hasOwnProperty("value")===!0?o.value:A.value!==void 0?A.value:""}Ce(()=>{F()}),Qe(()=>{e.autogrow===!0&&E()}),Object.assign(f,{innerValue:A,fieldClass:O(()=>`q-${x.value===!0?"textarea":"input"}`+(e.autogrow===!0?" q-textarea--autogrow":"")),hasShadow:O(()=>e.type!=="file"&&typeof e.shadowText=="string"&&e.shadowText.length!==0),inputRef:T,emitValue:_,hasValue:v,floatingLabel:O(()=>v.value===!0&&(e.type!=="number"||isNaN(A.value)===!1)||Qt(e.displayValue)),getControl:()=>L(x.value===!0?"textarea":"input",{ref:T,class:["q-field__native q-placeholder",e.inputClass],style:e.inputStyle,...m.value,...z.value,...e.type!=="file"?{value:le()}:M.value}),getShadowControl:()=>L("div",{class:"q-field__native q-field__shadow absolute-bottom no-pointer-events"+(x.value===!0?"":" text-no-wrap")},[L("span",{class:"invisible"},le()),L("span",e.shadowText)])});const j=os(f);return Object.assign(n,{focus:g,select:R,getNativeElement:()=>T.value}),Ba(n,"nativeEl",()=>T.value),j}});function Xe(e){return`Cannot initialize Office APIs: ${e} 
Are you viewing this within the Excel side panel?`}async function Wa(e=!1){const t=e?De().tracker.startOperation("Initialize Office APIs"):null;try{if(typeof Office>"u"){const n=Xe("`Office` is not defined in any loaded module.");throw t?.addInfo(n),new Error(n)}if(Office==null){const n=Xe("`Office` is defined as `null` or `undefined`.");throw t?.addInfo(n,{Office}),new Error(n)}if(!("onReady"in Office)||typeof Office.onReady!="function"){const n=Xe("`Office` does not have an `onReady` property, or it is not a function.");throw t?.addInfo(n,{Office}),new Error(n)}let a;try{a=await Office.onReady()}catch(n){const s=Xe(`Error while getting Office ready: '${xe(n)}'.`);throw t?.addInfo(s,{Error:n}),new Error(s)}if(a.host===null&&a.platform===null){const n=Xe("API is loaded and ready, but no suitable environment was detected.");throw t?.addInfo(n),new Error(n)}return t?.setSuccess("Office APIs are ready.",{onReadyInfo:a}),a}catch(a){if(t)return t.setFailureAndRethrow(a);throw a}}const Ga="CC923F2C-0638-4F36-9E18-A4910CD71B74",He=`${Ga}.config`,ht=`${Ga}.v1ApiToken`,yt=ps();function Ke(){const e=new io;return Office.context.document.settings.saveAsync(t=>{t.status===Office.AsyncResultStatus.Succeeded?e.tryResolve():e.tryReject(t.error)}),e.promise()}async function ps(){const e=ae().startOperation("Init Document Settings");try{await Wa();const t=(()=>{const o=Office.context.document.settings.get(He);return o?(e.addInfo("DocumentConfig loaded.",o),o):(e.addInfo("DocumentConfig not found. Will use defaults."),{appVersion:"",lastCompletedSyncUtc:"",lastCompletedSyncVersion:0})})(),a=(()=>{const o=Office.context.document.settings.get(ht);return Jt(o)?(e.addInfo(`ExpLens loaded the LunchMoney API Token from the document (${o.length} chars).`),o.toString()):(e.addInfo("ExpLens could NOT load the LunchMoney API Token from the document."),null)})();let n=he(t.lastCompletedSyncUtc)?null:new Date(t.lastCompletedSyncUtc);n!==null&&isNaN(n.getTime())&&(e.addInfo(`ERROR! lastCompletedSyncUtc (='${t.lastCompletedSyncUtc}') cannot be parsed into a valid date.`),n=null);const s={appVersion:B(t.appVersion),lastCompletedSyncUtc:B(n),lastCompletedSyncVersion:B(t.lastCompletedSyncVersion),apiToken:B(a)};return J(s.appVersion,async o=>{const r=await yt,l={appVersion:o,lastCompletedSyncUtc:r.lastCompletedSyncUtc.value?r.lastCompletedSyncUtc.value.toISOString():"",lastCompletedSyncVersion:r.lastCompletedSyncVersion.value};Office.context.document.settings.set(He,l),await Ke()}),J(s.lastCompletedSyncUtc,async o=>{const r=await yt,l={appVersion:r.appVersion.value,lastCompletedSyncUtc:o===null?"":o.toISOString(),lastCompletedSyncVersion:r.lastCompletedSyncVersion.value};Office.context.document.settings.set(He,l),await Ke()}),J(s.lastCompletedSyncVersion,async o=>{const r=await yt,l={appVersion:r.appVersion.value,lastCompletedSyncUtc:r.lastCompletedSyncUtc.value?r.lastCompletedSyncUtc.value.toISOString():"",lastCompletedSyncVersion:o};Office.context.document.settings.set(He,l),await Ke()}),e.setSuccess(),s}catch(t){return e.setFailureAndRethrow(t)}}async function ta(){const e=await yt;return{appVersion:Fn(e.appVersion),lastCompletedSyncUtc:e.lastCompletedSyncUtc,lastCompletedSyncVersion:e.lastCompletedSyncVersion,apiToken:e.apiToken,storeApiToken:async()=>{const t=ae().startOperation("Storing API token in the document.");try{Office.context.document.settings.set(ht,e.apiToken.value),await Ke(),t.setSuccess()}catch(a){t.setFailureAndRethrow(a)}},clearAllStorage:async()=>{const t=ae().startOperation("Clearing all settings from the document store.");try{Office.context.document.settings.remove(He),Office.context.document.settings.remove(ht),await Ke(),t.setSuccess()}catch(a){t.setFailureAndRethrow(a)}},clearTokenStorage:async()=>{const t=ae().startOperation("Clearing API Token all settings from the document store.");try{Office.context.document.settings.remove(He),Office.context.document.settings.remove(ht),await Ke(),t.setSuccess()}catch(a){t.setFailureAndRethrow(a)}}}}async function vs(e,t){const a=t.workbook.tables.getItemOrNullObject(e);if(a.load("name, id, worksheet, isNullObject"),await t.sync(),a.isNullObject)return null;const n=a.worksheet,s=a.getRange();return n.load("name, id"),s.load("address"),await t.sync(),{table:a,sheet:n,range:s}}async function _t(e,t,a){t.load(["id"]),await a.sync();const n=t.id,s=await vs(e,a);if(s===null)return null;if(s.sheet.id!==n)throw new Error(`Table '${e}' exists on the wrong sheet ('${s.range.address}').
 NOTE: Don't name any objects using prefix 'EL.'; Don't edit any auto-created sheets, except where specified.
 SOLUTION: Back-up your data, delete or rename the unexpected table, reload the Add-In.`);return s}async function Bt(e,t){let a=t.workbook.worksheets.getItemOrNullObject(e);return a.load("name, id, isNullObject"),await t.sync(),a.isNullObject&&(a=t.workbook.worksheets.add(e),await t.sync()),a.activate(),a.load("name, id, isNullObject"),await t.sync(),a}function Ya(e,t=!1){const a=e.getTime();if(isNaN(a))throw new Error(`Invalid date '${String(e)}'.`);const n=t?a-e.getTimezoneOffset()*60*1e3:a,s=Math.abs(Date.UTC(1899,11,30)),o=1440*60*1e3,r=(n+s)/o,l=10**8;return Math.round(r*l)/l}function Ie(e){if(e===void 0)return;if(e===null)return null;const t=new Date(e);try{return Ya(t)}catch(a){throw typeof a=="object"&&a instanceof Error&&a.message.startsWith("Invalid date")?new Error(`Invalid date string '${e}'.`,{cause:a}):a}}function Y(e,t,a,n,s,o){return e.getRangeByIndexes(t.row+a,t.col+n,s,o)}function hs(e){const t=e.indexOf("!");return t<0?e.trim():e.substring(t+1).trim()}function Za(e){return e.replace(/([A-Z]+)(\d+)/g,"$$$1$$$2")}async function ys(e,t,a){let n,s=!1;try{n=await e.text(),s=!0}catch(l){n=`Error getting response text (${xe(l)})`}let o={_:"Response text not available for parsing."};if(s)try{o=JSON.parse(n)}catch(l){o={errorParsingResponseText:xe(l)}}const r=t?`(${t}) `:"";a.setFailure(`Request ${r}failed with status ${e.status} (${e.statusText}).`,{responseText:n,responseObject:o})}async function xt(e,t,a,n){const s=De().tracker.startOperation("Calling remote API",a);try{if(s.addInfo({method:e,api:t}),n!==void 0?s.addInfo({apiToken:`specified (${n.length} chars)`}):n=(await ta()).apiToken.value??void 0,!Jt(n))throw new Error(`Cannot '${a}', because no API Token is set.`);const o=new Headers;o.append("Authorization",`Bearer ${n}`);const r=`https://dev.lunchmoney.app/v1/${t}`,l=await fetch(r,{method:e,headers:o,redirect:"follow"});if(!l.ok)throw await ys(l,a,s),new Error(`Bad response (${l.status}) during '${a}'.`);const d=await l.text();return s.setSuccess(),d}catch(o){return s.setFailureAndRethrow(o,{method:e,api:t,purposeDescription:a})}}function aa(e,t,a){const n=(o,r)=>{if(o<0||100<o)throw new Error(`'${r}' must be in range 0..100%, but it is '${o}%'.`)};if(n(e,"sheetProgressPercentageRangeStart"),n(t,"sheetProgressPercentageRangeEnd"),t<=e)throw new Error(`Expected sheetProgressPercentageRangeStart < sheetProgressPercentageRangeEnd, but found: sheetProgressPercentageRangeStart='${e}', sheetProgressPercentageRangeEnd='${t}'.`);const s=t-e;return{setPercentage:o=>{n(o,"relativeProgressPercentage");const r=e+s/100*o;a.progressPercentage.value=r}}}const bs="EL.Tags",$e="EL.TagsTable",Dt="EL.TagGroupsTable",Xa=":",ws=":Ungrouped";function Ja(e){return[...e.keys()].sort()}function en(e,t){const a=e.get(t);return a===void 0?[]:[...a].sort()}function _s(e,t){let a=e.get(t.group);return a===void 0&&(a=new Set,e.set(t.group,a)),a.add(t.value),e}function tn(e){const t=e.indexOf(Xa);return t<0?{group:ws,value:e,isGrp:!1,name:e.trim()}:{group:e.substring(0,t),value:e.substring(t+1),isGrp:!0,name:e.trim()}}async function Ts(e){const t=aa(3,15,e);t.setPercentage(0),e.sheets.tags.activate(),await e.excel.sync();const a=e.sheets.tags.getRange("B4:F4");a.clear();const n=a.getCell(0,0);await e.excel.sync();const s=De().tracker.startOperation("Download Tags");try{t.setPercentage(5);const o={row:7,col:1},r="Structured:Group",l="Structured:Value",d=["id","name","description","archived",r,l];{e.sheets.tags.getRange("B2").values=[["Tags"]],e.sheets.tags.getRange("B2:E2").style="Heading 1";const v=e.sheets.tags.getRange("B3:E3");v.clear(),v.merge(),v.format.horizontalAlignment=Excel.HorizontalAlignment.left,v.format.verticalAlignment=Excel.VerticalAlignment.center,v.format.fill.color="#fff8dc",v.format.font.color="d76dcc",v.format.font.size=10,v.getCell(0,0).values=[["This tab is managed by ExpLens. Do not modify."]],await e.excel.sync()}t.setPercentage(10);const c=await xt("GET","tags","get all tags"),w=JSON.parse(c);t.setPercentage(50),Y(e.sheets.tags,o,-3,0,1,1).values=[["Tags"]],Y(e.sheets.tags,o,-3,0,1,d.length).style="Heading 2",await e.excel.sync();const T=await _t($e,e.sheets.tags,e.excel),y=T!==null?T.table:await(async()=>{const v=e.sheets.tags.tables.add(Y(e.sheets.tags,o,0,0,2,1),!0);return v.name=$e,v.style="TableStyleMedium10",await e.excel.sync(),s.addInfo(`New Tags table '${$e}' created.`),v})();for(y.columns.load("count"),y.rows.load("count"),await e.excel.sync();y.columns.count<d.length;)y.columns.add(),y.columns.load("count"),await e.excel.sync();for(;y.columns.count>d.length;)y.columns.getItemAt(0).delete(),y.columns.load("count"),await e.excel.sync();y.getHeaderRowRange().values=[d],y.columns.load("count"),await e.excel.sync(),y.rows.count>1&&y.rows.deleteRowsAt(0,y.rows.count-1),y.getDataBodyRange().values=[Array(d.length).fill("")],y.rows.load("count"),await e.excel.sync();{const v=y.getRange();v.load("address"),await e.excel.sync(),s.addInfo(`Tags table "${$e}" is located at "${v.address}", it has ${y.columns.count} columns and ${y.rows.count} row(s).`)}const A=Y(e.sheets.tags,o,-1,0,1,1);A.format.fill.clear(),A.format.font.color="#7e350e",A.format.font.bold=!0,A.format.horizontalAlignment="Right",A.values=[["Count:"]];const I=Y(e.sheets.tags,o,-1,1,1,1);I.format.fill.color="#f2f2f2",I.format.font.color="#7e350e",I.format.font.bold=!0,I.format.horizontalAlignment="Left",I.formulas=[[`="  " & COUNTA(${$e}[name])`]],await e.excel.sync(),t.setPercentage(60),e.tags.assignable.clear(),e.tags.groupListFormulaLocations.clear(),e.tags.byId.clear();const $=w.sort((v,C)=>uo(v.name,C.name));for(let v=0;v<$.length;v++){const C=$[v],f=tn(C.name);_s(e.tags.assignable,f),e.tags.byId.set(C.id,f);const x=[C.id,C.name,C.description,C.archived,f.group,f.value];v===0?y.rows.getItemAt(0).getRange().values=[x]:y.rows.add(-1,[x]),y.rows.load("count"),await e.excel.sync()}y.getRange().format.autofitColumns(),await e.excel.sync(),Y(e.sheets.tags,o,-3,0,1,1).values=[["LunchMoney Tags"]],await e.excel.sync(),s.addInfo(`Tags table has ${y.rows.count} rows after the refresh.`),t.setPercentage(75);const k={row:o.row,col:o.col+d.length+1};Y(e.sheets.tags,k,-3,0,1,1).values=[["Tag Groups"]],Y(e.sheets.tags,k,-3,0,1,e.tags.assignable.size).style="Heading 2",await e.excel.sync();const N=await _t(Dt,e.sheets.tags,e.excel);N!==null&&(N.table.delete(),await e.excel.sync()),t.setPercentage(85);const Q=Ja(e.tags.assignable);for(let v=0;v<Q.length;v++){const C=Q[v],f=Y(e.sheets.tags,k,0,v,1,1),x=Y(e.sheets.tags,k,1,v,1,1),q=Y(e.sheets.tags,k,2,v,1,1),z=Y(e.sheets.tags,k,3,v,1,1),m=en(e.tags.assignable,C).length,g=Y(e.sheets.tags,k,3,v,m,1);f.load(["address"]),x.load(["address"]),z.load(["address"]),await e.excel.sync();const R=hs(f.address),S=Za(z.address);e.tags.groupListFormulaLocations.set(C,S),f.formulas=[[""]],f.values=[[C]],q.values=[[""]],q.formulas=[[""]],q.format.fill.clear(),g.values=Array(m).fill([""]),g.formulas=Array(m).fill([""]),g.format.fill.color="#f2f2f2",g.format.font.color="#7e350e",g.format.font.bold=!1,g.format.horizontalAlignment="Left";const u=g.format.borders.getItem("EdgeLeft");u.color="white",u.style="Continuous",u.weight="Medium",z.values=[[""]],z.formulas=[[`= FILTER(${$e}[${l}], ${$e}[${r}]=${R})`]],x.values=[[""]],x.formulas=[[`= COUNTA(${S}#)`]],f.format.autofitColumns(),z.format.autofitColumns(),await e.excel.sync()}t.setPercentage(95);const M=e.sheets.tags.tables.add(Y(e.sheets.tags,k,0,0,2,Q.length),!0);M.name=Dt,M.style="TableStyleMedium10",await e.excel.sync(),s.addInfo(`New Tags Groups table '${Dt}' created.`),t.setPercentage(100),s.setSuccess()}catch(o){n.values=[[`ERR: ${xe(o)}`]],n.format.font.color="#FF0000",await e.excel.sync(),s.setFailureAndRethrow(o)}}var qe,Ve;class rt{constructor(){Pt(this,qe,[]);Pt(this,Ve,new Map);Ne(this,"tryAdd",(t,a)=>ye(this,Ve).has(t)?!1:(ye(this,qe).push(a),ye(this,Ve).set(t,a),!0));Ne(this,"has",t=>ye(this,Ve).has(t));Ne(this,"getByIndex",t=>ye(this,qe)[t]);Ne(this,"getByKey",t=>ye(this,Ve).get(t));Ne(this,"map",t=>ye(this,qe).map(t))}get length(){return ye(this,qe).length}[Symbol.iterator](){return ye(this,qe)[Symbol.iterator]()}}qe=new WeakMap,Ve=new WeakMap;const Cs="EL.Categories",Le="EL.CategoriesTable",ke=["LabelId","description","is_group","is_income","exclude_from_budget","exclude_from_totals","archived","created_at","updated_at","archived_on","LabelL1","LabelL2","LunchId","order","name"];function Ss(e){const t=[];for(const a of ke)t.push(e[a]);return t}function Oa(e,t){e=e.trim();let a=0;for(let n=0;n<e.length;n++)if(e[n]==="/"&&(a++,a===t))return e.substring(0,n);return e}async function ks(e){const t=aa(16,30,e);t.setPercentage(0),e.sheets.cats.activate(),await e.excel.sync();const a=e.sheets.cats.getRange("B4:F4");a.clear();const n=a.getCell(0,0);await e.excel.sync();const s=ae().startOperation("Download Categories");try{t.setPercentage(2);const o=await xt("GET","categories?format=flattened","get all categories");t.setPercentage(35);const r=JSON.parse(o);t.setPercentage(40);const l=new Map;for(const f of r.categories)l.set(f.id,f);const d=[];for(const f of l.values()){const x=m=>m===null?void 0:l.get(m);let q=f.name.trim(),z=x(f.group_id);for(;z;)q=`${z.name.trim()}/${q}`,z=x(z.group_id);d.push({LabelId:q,is_group:f.is_group,is_income:f.is_income,exclude_from_budget:f.exclude_from_budget,exclude_from_totals:f.exclude_from_totals,description:f.description??"",updated_at:Ie(f.updated_at),archived:f.archived,created_at:Ie(f.created_at),archived_on:f.archived_on===null?"":Ie(f.archived_on),LabelL1:Oa(q,1),LabelL2:Oa(q,2),LunchId:f.id,order:f.order,name:f.name})}d.sort((f,x)=>f.order-x.order),e.cats.assignable=new rt;for(const f of d)f.is_group!==!0&&f.archived!==!0&&e.cats.assignable.tryAdd(f.LunchId,f.LabelId);t.setPercentage(55),await _t(Le,e.sheets.cats,e.excel);const c={row:7,col:3},w={row:7,col:1};{e.excel.workbook.application.suspendApiCalculationUntilNextSync(),e.excel.workbook.application.suspendScreenUpdatingUntilNextSync();const f=e.sheets.cats.getUsedRange();f.clear(),f.conditionalFormats.clearAll(),Y(e.sheets.cats,c,0,0,1,ke.length).values=[ke];const x=d.map(z=>Ss(z));Y(e.sheets.cats,c,1,0,d.length,ke.length).values=x;const q=e.sheets.cats.tables.add(Y(e.sheets.cats,c,0,0,d.length+1,ke.length),!0);q.name=Le,q.style="TableStyleMedium12";for(let z=0;z<ke.length;z++){const m=ke[z];(m.endsWith("_on")||m.endsWith("_at"))&&(Y(e.sheets.cats,c,1,z,d.length,1).numberFormat=[["yyyy-mm-dd hh:mm"]])}}await e.excel.sync(),Y(e.sheets.cats,c,0,0,1,ke.length).format.autofitColumns(),await e.excel.sync(),t.setPercentage(80);const T=Y(e.sheets.cats,w,0,0,1,1);T.values=[["LabelId"]],T.format.fill.color="#0f9ed5",T.format.font.color="#FFFFFF";const y=Y(e.sheets.cats,w,1,0,1,1);y.load("address"),await e.excel.sync(),e.cats.listFormulaLocation=Za(y.address),y.formulas=[[`= LET(
    LabelIdValues, ${Le}[LabelId],
    OrderValues, ${Le}[order],
    Filter, (${Le}[is_group] = FALSE) * (${Le}[archived] = FALSE),

    FilteredValues, FILTER(
        HSTACK(LabelIdValues, OrderValues),
        Filter
    ),
    SortedValues, SORTBY(FilteredValues, INDEX(FilteredValues,,2), 1),
    SortedAndFilteredLabelIds, INDEX(SortedValues,,1),
    SortedAndFilteredLabelIds
)`]];const A=e.cats.assignable.length,I=Y(e.sheets.cats,w,0,0,A+1,1);I.format.font.bold=!0;const $=I.format.borders.getItem("EdgeTop");$.color="#0f9ed5",$.weight="Thick",$.style="Continuous";const k=I.format.borders.getItem("EdgeLeft");k.color="#0f9ed5",k.weight="Thick",k.style="Continuous";const N=I.format.borders.getItem("EdgeRight");N.color="#0f9ed5",N.weight="Thick",N.style="Continuous";const Q=I.format.borders.getItem("EdgeBottom");Q.color="#0f9ed5",Q.weight="Thick",Q.style="Continuous",await e.excel.sync(),y.format.autofitColumns(),await e.excel.sync(),t.setPercentage(90);const M=Y(e.sheets.cats,c,-1,-1,1,1);M.values=[[" counts "]],M.format.horizontalAlignment="Center",M.format.font.color="#074f69",M.format.font.bold=!0;const v=Y(e.sheets.cats,c,-1,0,1,1);v.format.horizontalAlignment="Left",v.format.fill.color="#f2f2f2",v.format.font.color="#074f69",v.format.font.bold=!0,v.formulas=[[`="  " & COUNTA(${Le}[labelId])`]];const C=Y(e.sheets.cats,w,-1,0,1,1);C.format.horizontalAlignment="Left",C.format.fill.color="#f2f2f2",C.format.font.color="#074f69",C.format.font.bold=!0,C.formulas=[[`="  " & COUNTA(${e.cats.listFormulaLocation}#)`]],await e.excel.sync(),t.setPercentage(95);{e.sheets.cats.getRange("B2").values=[["Categories"]],e.sheets.cats.getRange("B2:E2").style="Heading 1";const f=e.sheets.cats.getRange("B3:E3");f.clear(),f.merge(),f.format.horizontalAlignment=Excel.HorizontalAlignment.left,f.format.verticalAlignment=Excel.VerticalAlignment.center,f.format.fill.color="#fff8dc",f.format.font.color="d76dcc",f.format.font.size=10,f.getCell(0,0).values=[["This tab is managed by ExpLens. Do not modify."]]}e.sheets.cats.getRange("B5").values=[["Assignable Categories"]],e.sheets.cats.getRange("B5:B5").style="Heading 2",e.sheets.cats.getRange("D5").values=[["All Categories"]],Y(e.sheets.cats,{row:4,col:3},0,0,1,ke.length).style="Heading 2",await e.excel.sync(),t.setPercentage(100),s.setSuccess()}catch(o){n.values=[[`ERR: ${xe(o)}`]],n.format.font.color="#FF0000",await e.excel.sync(),s.setFailureAndRethrow(o)}}const Tt="<Tag Groups Columns>",Wt=`Tag${Xa}`,_e={LunchId:"LunchId",LastSyncVersion:"LastSyncVersion"},Je='_($* #,##0.00_);_($* -#,##0.00_);_($* "-"??_);_(@_)',bt=[p("date",e=>Ie(e.trn.date),"yyyy-mm-dd"),p("Account",e=>e.trn.account_display_name),p("Payer",e=>(e.pld?.account_owner??"").replace(/[.,?!:_]/g," ").replace(/\s+/g," ").trim().replace(/\b(\w)(\w*)/g,(s,o,r)=>o+r.toLowerCase()),null,async(e,t,a)=>{e.font.load(["size"]),await a.excel.sync(),e.font.size=Math.max(e.font.size-2,9),e.horizontalAlignment="Left",await sn()?.(e,t,a)}),p("payee",e=>e.trn.payee),p("Amount",e=>e.trn.to_base,Je),p("Category",e=>zt(e.trn.category_group_name,e.trn.category_name),null,async(e,t,a)=>{t.clear(),await a.excel.sync(),t.ignoreBlanks=!0,Jt(a.cats.listFormulaLocation)?t.rule={list:{inCellDropDown:!0,source:`=${a.cats.listFormulaLocation}#`}}:t.prompt={showPrompt:!0,title:"",message:"Failed to determine valid options for Category"}}),p(Tt,e=>null),p("Plaid:MerchantCategory",e=>tt(e.pld?.category)),p("Plaid:TransactionCategory",e=>{const t=e.pld?.personal_finance_category?.primary?.replaceAll("_"," ").trim()??"",a=e.pld?.personal_finance_category?.detailed?.replaceAll("_"," ").trim()??"",n=a.startsWith(t)?a.slice(t.length).trim():a,s=/\b(\w)(\w*)/g,o=(d,c,w)=>c+w.toLowerCase(),r=t.replace(s,o),l=n.replace(s,o);return zt(r,l)}),p("status",e=>e.trn.status),p("recurring_description",e=>e.trn.recurring_description),p("ContainerMoniker",e=>`=LET(
    ContainerId, IFS(
        [@[group_id]] <> "", [@[group_id]],
        [@[parent_id]] <> "", [@[parent_id]],
        TRUE, ""
    ),
    ContainerPayee, XLOOKUP(ContainerId, [LunchId], [payee], ""),
    ContainerMoniker, IF(ContainerPayee <> "",
        ContainerPayee,
        IFS(
            AND(--[@[is_group]], --[@[has_children]]), "[_IS_GROUP_HAS_CHILDREN_]",
            [@[is_group]], "[_IS_GROUP_]",
            [@[has_children]], "[_HAS_CHILDREN_]",
            TRUE, ""
        )
    ),
    ContainerMoniker
)`),p("is_income",e=>e.trn.is_income),p("exclude_from_budget",e=>e.trn.exclude_from_budget),p("exclude_from_totals",e=>e.trn.exclude_from_totals),p("has_children",e=>e.trn.has_children),p("is_group",e=>e.trn.is_group),p("is_pending",e=>e.trn.is_pending),p("display_notes",e=>e.trn.display_notes),p("currency",e=>e.trn.currency),p("to_base",e=>e.trn.to_base,Je),p("category_id",e=>e.trn.category_id),p("category_name",e=>e.trn.category_name),p("category_group_id",e=>e.trn.category_group_id),p("category_group_name",e=>e.trn.category_group_name),p("created_at",e=>e.trn.created_at),p("updated_at",e=>e.trn.updated_at),p("notes",e=>e.trn.notes),p("original_name",e=>e.trn.original_name),p("recurring_id",e=>e.trn.recurring_id),p("recurring_payee",e=>e.trn.recurring_payee),p("recurring_cadence",e=>e.trn.recurring_cadence),p("recurring_granularity",e=>e.trn.recurring_granularity),p("recurring_quantity",e=>e.trn.recurring_quantity),p("recurring_type",e=>e.trn.recurring_type),p("recurring_amount",e=>e.trn.recurring_amount,Je),p("recurring_currency",e=>e.trn.recurring_currency),p("parent_id",e=>e.trn.parent_id),p("group_id",e=>e.trn.group_id),p("_amount",e=>e.trn.amount,Je),p("AccountWithOwner",e=>zt(e.trn.account_display_name,e.pld?.account_owner)),p("asset_id",e=>e.trn.asset_id),p("asset_institution_name",e=>e.trn.asset_institution_name),p("asset_name",e=>e.trn.asset_name),p("asset_display_name",e=>e.trn.asset_display_name),p("asset_status",e=>e.trn.asset_status),p("plaid_account_id",e=>e.trn.plaid_account_id),p("plaid_account_name",e=>e.trn.plaid_account_name),p("plaid_account_mask",e=>e.trn.plaid_account_mask),p("institution_name",e=>e.trn.institution_name),p("plaid_account_display_name",e=>e.trn.plaid_account_display_name),p("plaid_category",e=>e.trn.plaid_category??""),p("source",e=>e.trn.source),p("display_name",e=>e.trn.display_name),p("account_display_name",e=>e.trn.account_display_name),p("original_tags",e=>tt(e.trn.tags?.map(t=>t.name),on)),p("external_id",e=>e.trn.external_id),p("plaid:account_id",e=>e.pld?.account_id),p("plaid:account_owner",e=>e.pld?.account_owner),p("plaid:amount",e=>e.pld?.amount,Je),p("plaid:authorized_date",e=>Ie(e.pld?.authorized_date),"yyyy-mm-dd"),p("plaid:authorized_datetime",e=>Ie(e.pld?.authorized_datetime),"yyyy-mm-dd hh:mm:ss"),p("plaid:category,l1",e=>e.pld?.category?.[0]),p("plaid:category,l2",e=>tt([e.pld?.category?.[0],e.pld?.category?.[1]])),p("plaid:category,l3",e=>tt([e.pld?.category?.[0],e.pld?.category?.[1],e.pld?.category?.[2]])),p("plaid:category_id",e=>e.pld?.category_id),p("plaid:check_number",e=>e.pld?.check_number),p("plaid:counterparties.count",e=>e.pld?.counterparties?.length),p("plaid:counterparty#01.confidence_level",e=>e.pld?.counterparties?.[0]?.confidence_level),p("plaid:counterparty#01.entity_id",e=>e.pld?.counterparties?.[0]?.entity_id),p("plaid:counterparty#01.logo_url",e=>e.pld?.counterparties?.[0]?.logo_url),p("plaid:counterparty#01.name",e=>e.pld?.counterparties?.[0]?.name),p("plaid:counterparty#01.phone_number",e=>e.pld?.counterparties?.[0]?.phone_number),p("plaid:counterparty#01.type",e=>e.pld?.counterparties?.[0]?.type),p("plaid:counterparty#01.website",e=>e.pld?.counterparties?.[0]?.website),p("plaid:date",e=>Ie(e.pld?.date),"yyyy-mm-dd"),p("plaid:datetime",e=>Ie(e.pld?.datetime),"yyyy-mm-dd hh:mm:ss"),p("plaid:iso_currency_code",e=>e.pld?.iso_currency_code),p("plaid:location.address",e=>e.pld?.location?.address),p("plaid:location.city",e=>e.pld?.location?.city),p("plaid:location.country",e=>e.pld?.location?.country),p("plaid:location.lat",e=>e.pld?.location?.lat),p("plaid:location.lon",e=>e.pld?.location?.lon),p("plaid:location.postal_code",e=>e.pld?.location?.postal_code),p("plaid:location.region",e=>e.pld?.location?.region),p("plaid:location.store_number",e=>e.pld?.location?.store_number),p("plaid:logo_url",e=>e.pld?.logo_url),p("plaid:merchant_entity_id",e=>e.pld?.merchant_entity_id),p("plaid:merchant_name",e=>e.pld?.merchant_name),p("plaid:name",e=>e.pld?.name),p("plaid:payment_channel",e=>e.pld?.payment_channel),p("plaid:payment_meta.by_order_of",e=>e.pld?.payment_meta?.by_order_of),p("plaid:payment_meta.payee",e=>e.pld?.payment_meta?.payee),p("plaid:payment_meta.payer",e=>e.pld?.payment_meta?.payer),p("plaid:payment_meta.payment_method",e=>e.pld?.payment_meta?.payment_method),p("plaid:payment_meta.payment_processor",e=>e.pld?.payment_meta?.payment_processor),p("plaid:payment_meta.ppd_id",e=>e.pld?.payment_meta?.ppd_id),p("plaid:payment_meta.reason",e=>e.pld?.payment_meta?.reason),p("plaid:payment_meta.reference_number",e=>e.pld?.payment_meta?.reference_number),p("plaid:pending",e=>e.pld?.pending),p("plaid:pending_transaction_id",e=>e.pld?.pending_transaction_id),p("plaid:personal_finance_category.confidence_level",e=>e.pld?.personal_finance_category?.confidence_level),p("plaid:personal_finance_category.detailed",e=>e.pld?.personal_finance_category?.detailed),p("plaid:personal_finance_category.primary",e=>e.pld?.personal_finance_category?.primary),p("plaid:personal_finance_category.version",e=>e.pld?.personal_finance_category?.version),p("plaid:personal_finance_category_icon_url",e=>e.pld?.personal_finance_category_icon_url),p("plaid:transaction_code",e=>e.pld?.transaction_code),p("plaid:transaction_id",e=>e.pld?.transaction_id),p("plaid:transaction_type",e=>e.pld?.transaction_type),p("plaid:unofficial_currency_code",e=>e.pld?.unofficial_currency_code),p("plaid:website",e=>e.pld?.website),p(_e.LunchId,e=>e.trn.id,null,e=>{e.font.size=6,e.verticalAlignment="Center",e.horizontalAlignment="Right"}),p("plaid:website",e=>e.pld?.website),p(_e.LastSyncVersion,e=>null)];function p(e,t,a=null,n=null){return{name:e.trim(),valueFn:t,numberFormat:a,formatFn:n??sn()}}function As(e,t){const a=t?.tags.groupListFormulaLocations.get(e),n=async(s,o,r)=>{o.clear(),await r.excel.sync(),o.ignoreBlanks=!0,a?o.rule={list:{inCellDropDown:!0,source:`=${a}#`}}:o.prompt={showPrompt:!0,title:"",message:`Failed to determine valid options for '${Ct(e)}'`}};return{name:Ct(e),valueFn:s=>an(s,e),numberFormat:null,formatFn:n}}function xs(e){const t=Ja(e.tags.assignable).map(s=>As(s,e)),a=bt.flatMap(s=>s.name===Tt?t:s),n=new rt;for(const s of a)n.tryAdd(s.name,s);return n}function Rs(){let e=bt.findIndex(t=>t.name===Tt);return e>=0||(De().tracker.observeEvent(co.Wrn,`The 'transactionColumnsSpecs' should contain '${Tt}', but it does not. A graceful fallback will be used, but this should be addressed!`),e=bt.findIndex(t=>t.name.toUpperCase()==="CATEGORY"),e<0&&(e=bt.findIndex(t=>t.name.toUpperCase()==="PAYEE")),e<0&&(e=0)),e}function an(e,t){const a=en(e.tag,t);return tt(a,on)}function Ct(e){return`${Wt}${e}`.trim()}function St(e){if(e=e.trim(),!!e.startsWith(Wt))return e.substring(Wt.length)}function Ma(e,t,a){const n=a.getByKey(t);let s;if(n!==void 0)s=n.valueFn(e);else{const o=St(t);if(o!==void 0)s=an(e,o);else throw new Error(`Cannot find specification for column '${t}'.`)}return s??""}const nn=" / ",on=", ";function zt(e,t,a=nn){const n=e??"",s=t??"";return n.length>0&&s.length>0?n+a+s:n+s}function tt(e,t=nn){return e==null?null:e.map(a=>he(a)?"*":a).join(t)}function sn(){return null}const Es="EL.Transactions",Gt="EL.TransactionsTable";async function Ps(e,t,a){const n=ae().startOperation("Create new Transactions table");try{const s={row:7,col:1},o=e.map(d=>d.name),r=Y(t,s,0,0,2,o.length);r.clear(),r.conditionalFormats.clearAll(),await a.sync(),Y(t,s,0,0,1,o.length).values=[o];const l=t.tables.add(r,!0);return l.name=Gt,l.style="TableStyleMedium9",await a.sync(),l.load(["name","id"]),l.getRange().load(["address"]),await a.sync(),n.setSuccess(`New Transactions table '${l.name}' created.`),l}catch(s){return n.setFailureAndRethrow(s)}}async function Is(e,t){e.columns.load(["count","items"]),e.rows.load(["count"]),await t.excel.sync();const a=t.tags.assignable.keys().map(r=>Ct(r)),n=new Set(a);let s;for(let r=0;r<e.columns.count;r++){const l=e.columns.getItemAt(r).load(["name"]);if(await t.excel.sync(),n.delete(l.name),n.size===0)return;St(l.name)&&(s=s===void 0?r:s)}s===void 0&&(s=Rs());const o=[...n].sort().reverse();for(const r of o)e.columns.add(s,void 0,r);await t.excel.sync()}function kt(e,t){switch(e.clear(),e.format.horizontalAlignment=Excel.HorizontalAlignment.center,e.format.verticalAlignment=Excel.VerticalAlignment.center,e.format.font.size=10,t){case"Read-Only":e.format.fill.color="#f2ceef",e.format.font.color="#d76dcc";break;case"Editable":e.format.fill.color="#b5e6a2",e.format.font.color="#4ea72e";break}e.dataValidation.prompt={showPrompt:!0,title:`${t} column`,message:t==="Read-Only"?"Let ExpLens manage it for you.":t==="Editable"?"Select a value from the dropdown":""}}async function qs(e){e.sheets.trans.getRange("B2").values=[["Transactions"]],e.sheets.trans.getRange("B2:E2").style="Heading 1";const t=e.sheets.trans.getRange("B3:E3");t.clear(),t.merge(),t.format.horizontalAlignment=Excel.HorizontalAlignment.left,t.format.verticalAlignment=Excel.VerticalAlignment.center,t.format.fill.color="#fff8dc",t.format.font.color="d76dcc",t.format.font.size=10,t.getCell(0,0).values=[["This tab is managed by ExpLens. Only modify specific columns:"]];const a=e.sheets.trans.getRange("B4:B4");kt(a,"Editable"),a.format.font.bold=!0,a.values=[["Editable Columns"]];const n=e.sheets.trans.getRange("C4:C4");kt(n,"Read-Only"),n.format.font.bold=!0,n.values=[["Read-Only Columns"]],await e.excel.sync()}async function Os(e,t,a){const n=ae().startOperation("Create Read-Only vs Editable hint header row for Transactions");try{const s=e.getRange();s.load(["address","rowIndex","columnIndex"]),await a.excel.sync();const o=new Set(["Category"]);for(const d of a.tags.assignable.keys())o.add(Ct(d));const r={row:s.rowIndex-1,col:s.columnIndex},l=Y(a.sheets.trans,r,0,0,1,t.length);kt(l,"Read-Only"),await a.excel.sync();for(let d=0;d<e.columns.count;d++){const c=t[d];if(c&&o.has(c)){const w=Y(a.sheets.trans,r,0,d,1,1);kt(w,"Editable")}}await a.excel.sync(),n.setSuccess()}catch(s){n.setFailureAndRethrow(s)}}function Ms(e,t){const a=ae().startOperation("Validate Transactions table Column names");try{let n=0,s=0;for(;;){for(;n<e.length&&St(e.getByIndex(n).name);)n++;for(;s<t.length&&St(t[s]);)s++;if(n===e.length&&s===t.length)return a.setSuccess(),!0;if(n===e.length||s===t.length)return a.setFailure(`isColumnNamingEquivalent(..):
The lengths of 'columnsSpecs' (${e.length}) and actualColumnNames (${t.length}) are different after accounting for dynamic tag columns.`),!1;if(e.getByIndex(n)?.name!==t[s])return a.setFailure(`isColumnNamingEquivalent(..):
After accounting for dynamic tag columns, aligned headers are not the same:
columnsSpecs.getByIndex(${n})?.name !== actualColumnNames[${s}] ('${e.getByIndex(n)?.name}' !=== '${t[s]}').`),!1;n++,s++}}catch(n){return a.setFailureAndRethrow(n)}}async function $s(e,t,a){const n=ae().startOperation(`Read ${e.rows.count} existing data rows from '${e.name}'`);let s=null;try{const o=new rt,r=t.findIndex(c=>c===_e.LunchId),d=e.columns.getItemAt(r).getDataBodyRange();d.load(["values"]),await a.excel.sync();for(let c=0;c<e.rows.count;c++){c%250===0&&(s?.setSuccess(),s=ae().startOperation(`Read rows ${c}...${c+250}, out of ${e.rows.count} from '${e.name}'`));const T=e.rows.getItemAt(c).getRange(),y=d.values[c];if(y===void 0)throw new Error(`readExistingTransactions: idColRange.values[${c}] should be a one element array containing the id, but it is undefined.`);const A=y[0];if(A===void 0)throw new Error(`readExistingTransactions: lunchId (=idColRange.values[${c}][0]) should be a number (the ID), but it is undefined.`);const I=Number(A);if(!Number.isInteger(I))throw new Error(`Invalid ${_e.LunchId}-value ('${A}') for item on row ${c}.`);o.tryAdd(I,T)}return s?.setSuccess(),n.setSuccess(`Done reading ${o.length} existing data rows from table '${e.name}'.`),o}catch(o){return s?.setFailure(o),n.setFailureAndRethrow(o)}}async function Ls(e,t){if(e>t){const n=e;e=t,t=n}const a=ae().startOperation(`Retrieve transactions from Lunch Money (${ct(e)}...${ct(t)})`);try{const n=[];let s=e;for(;s<=t;){const l=new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth()+1,0)),d=l<t?l:t,c=ct(s),w=ct(d),T=await xt("GET",`transactions?start_date=${c}&end_date=${w}`,`get all transactions ${c}...${w}`),y=ae().startOperation(`Parse fetched transactions ${c}...${w}`);try{const A=JSON.parse(T);if(A.has_more)throw new Error(`The LunchMoney 'v1/transactions' API returned 'true' in the 'has_more' field.
 This was previously not supported by the backend, but it has apparently changed. This is a breaking change in the backend API. The ExpLense needs to be updated and tested to account for this.
 Please reach out to the developers on GitHub.`);if(A.transactions===void 0){const $=A.error;throw $?new Error(`LunchMoney returned a non-error-code response, but the payload contains an error message instead of data:
 "${$}"`):new Error("LunchMoney returned a non-error-code response, but the payload contains does not contain expected data.")}const I=A.transactions.length;for(let $=0;$<I;$++){const k=A.transactions[$];if(k===void 0)throw new Error(`fetched.transactions[${$}] is undefined, but fetched.transactions.length=${I}`);n.push(k)}y.setSuccess({countFetched:A.transactions.length})}catch(A){y.setFailureAndRethrow(A)}s=new Date(Date.UTC(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()+1))}const o=ae().startOperation(`Parse Tags, Plaid & other metadata, and hydrate ${n.length} transactions`),r=new rt;try{let l=0;for(let d=0;d<n.length;d++){const c=n[d];if(!c)continue;const w=c.id;if(!Number.isInteger(w))throw new Error(`Cannot parse ID of fetched transaction #${d}. Integer ID expected. (Actual id='${w}'.)`);const T={trn:c,pld:null,tag:new Map,id:w};r.tryAdd(T.id,T);const y=c.plaid_metadata;if(y!=null&&typeof y=="string"){const $=JSON.parse(y);T.pld=$,l++}const I=T.trn.tags??[];for(const $ of I){const k=tn($.name);let N=T.tag.get(k.group);N===void 0&&(N=new Set,T.tag.set(k.group,N)),N.add(k.value)}}o.setSuccess({countAllFetchedTrans:n.length,countPlaidMetadataObjectsParsed:l,note:"(Not all transactions have Plaid Metadata, e.g., groups, split transactions, transactions imported form sources other than Plaid...)"})}catch(l){o.setFailureAndRethrow(l)}return a.setSuccess(),r}catch(n){return a.setFailureAndRethrow(n)}}async function Fs(e,t,a,n){const s=ae().startOperation("Apply formatting to table columns");let o=null;try{for(let r=0;r<t.length;r++){r%30===0&&(o?.setSuccess(),o=ae().startOperation(`Format table columns ${r}...${r+30}, out of ${t.length}`));const d=t[r],c=e.columns.getItemAt(r),w=a.getByKey(d);if(w===void 0)continue;const T=w.numberFormat,y=w.formatFn;if(T===null&&y===null)continue;const A=c.getDataBodyRange();if(T&&(A.numberFormat=[[T]]),y)try{await y(A.format,A.dataValidation,n),await n.excel.sync()}catch(I){const $=`The formatFn of the column spec for '${d}' threw an error
(${xe(I)})
We will skip over this and continue, but this needs to be corrected.`;o?.addInfo($,I),s.addInfo($,I)}}await n.excel.sync(),o?.setSuccess(),s.setSuccess()}catch(r){o?.setFailure(r),s.setFailureAndRethrow(r)}}async function Vs(e,t){const a=e.getRange();a.load(["address","rowIndex","columnIndex","name"]),await t.excel.sync();const n={row:a.rowIndex-2,col:a.columnIndex},s=Y(t.sheets.trans,n,0,0,1,1);s.format.fill.clear(),s.format.font.color="#7e350e",s.format.font.bold=!0,s.format.horizontalAlignment="Right",s.values=[["Count:"]];const o=Y(t.sheets.trans,n,0,1,1,1);o.format.fill.color="#f2f2f2",o.format.font.color="#7e350e",o.format.font.bold=!0,o.format.horizontalAlignment="Left",o.formulas=[[`="  " & COUNTA(${e.name}[${_e.LunchId}])`]];const r=Y(t.sheets.trans,n,0,3,1,1);r.format.fill.clear(),r.format.font.color="#7e350e",r.format.font.bold=!0,r.format.horizontalAlignment="Right",r.values=[["Last completed download data version / time:"]];const l=Y(t.sheets.trans,n,0,4,1,1);l.format.fill.color="#f2f2f2",l.format.font.color="#7e350e",l.format.font.bold=!0,l.format.horizontalAlignment="Left",l.formulas=[[`="  " & "${t.currentSync.version}"`]];const d=Y(t.sheets.trans,n,0,5,1,1);d.format.fill.color="#f2f2f2",d.format.font.color="#7e350e",d.format.font.bold=!0,d.format.horizontalAlignment="Left",d.values=[[Ya(t.currentSync.utc,!0)]],d.numberFormat=[["  yyyy-mm-dd  HH:mm:ss"]],await t.excel.sync()}async function Bs(e,t,a){const n=aa(31,90,a);n.setPercentage(0),a.sheets.trans.activate(),await a.excel.sync();const s=a.sheets.trans.getRange("B5:F5");s.clear();const o=s.getCell(0,0);await a.excel.sync();const r=ae().startOperation("Download Transactions");try{n.setPercentage(5),await qs(a);const l=xs(a);a.sheets.trans.getRange("A:A").format.columnWidth=15,await a.excel.sync();const d=await _t(Gt,a.sheets.trans,a.excel),c=d===null?await Ps(l,a.sheets.trans,a.excel):d.table;await Is(c,a);{a.sheets.trans.freezePanes.unfreeze(),await a.excel.sync();const v=c.getHeaderRowRange();v.load(["rowIndex"]),await a.excel.sync(),a.sheets.trans.freezePanes.freezeRows(v.rowIndex+1),await a.excel.sync()}const w=ae().startOperation("Load Transactions table column names");try{c.columns.load(["count","items"]),await a.excel.sync();for(const v of c.columns.items)v.load("name");await a.excel.sync(),w.setSuccess()}catch(v){w.setFailureAndRethrow(v)}const T=c.columns.items.map(v=>v.name.trim());if(await Os(c,T,a),!T.includes(_e.LunchId))throw new Error(`Table '${c.name}' (${d===null?"newly created":"pre-existing"}) does not contain the expected column '${_e.LunchId}'.`);if(!Ms(l,T))throw new Error(`Columns in table '${Gt}' do not match expected transaction header structure. Try deleting the entire table.`);n.setPercentage(10);const y=ae().startOperation("Delete empty rows from the Transactions table");try{const v=c.getDataBodyRange();c.rows.load(["count"]),v.load("values"),await a.excel.sync();const C=c.rows.count,f=v.values;let x=0;for(let q=f.length-1;q>=0;q--){if(q===0&&x===C-1)continue;f[q].every(g=>he(g))&&(c.rows.getItemAt(q).delete(),x++)}c.rows.load(["count","items"]),await a.excel.sync(),y.setSuccess({countEmptyRowsDeleted:x})}catch(v){y.setFailureAndRethrow(v)}n.setPercentage(15);const A=await $s(c,T,a);n.setPercentage(30);const I=await Ls(e,t);n.setPercentage(60);const $=[],k=ae().startOperation("Merge received and existing transactions");let N=null;try{const v=T.findIndex(f=>f===_e.LastSyncVersion),C={sameAsReceived:0,differentFromReceived:0,notComparedWithReceived:0};for(let f=0;f<I.length;f++){f%250===0&&(N?.setSuccess(),N=ae().startOperation(`Merge transactions ${f}...${f+250}, out of ${I.length}`));const q=I.getByIndex(f);if(q===void 0)continue;const z=A.getByKey(q.id);if(z!==void 0){if(!a.isUpdateExistingTransactions){C.notComparedWithReceived++;continue}z.load(["values","formulas"]),await a.excel.sync();const m=z.values[0],g=z.formulas[0];let R=!1;for(let S=0;S<m.length;S++){if(S===v)continue;const u=T[S],i=m[S],_=Ma(q,u,l);i!==_&&(typeof i=="number"&&typeof _=="string"&&Number(_.trim())===i||(g[S]===_?m[S]=g[S]:(m[S]=_,R=!0)))}R?(m[v]=a.currentSync.version,z.values=[m],C.differentFromReceived++,await a.excel.sync()):C.sameAsReceived++}else{const m=[];for(const g of T)g===_e.LastSyncVersion?m.push(a.currentSync.version):m.push(Ma(q,g,l));$.push(m)}}N?.setSuccess(),k.setSuccess({countReceivedTrans:I.length,isReplaceExistingTrans:a.isUpdateExistingTransactions,countExistingTransFound:C,countTranRowsToAdd:$.length})}catch(v){N?.setFailure(v),k.setFailureAndRethrow(v)}n.setPercentage(67);const Q=ae().startOperation("Insert rows into Transactions table",{rowCount:$.length});try{let C=0;for(;C<$.length;){const f=ae().startOperation(`Insert rows ${C}...${C+250} of ${$.length}`);try{const x=$.slice(C,C+250);c.rows.add(0,x),await a.excel.sync(),C+=250,f.setSuccess()}catch(x){f.setFailureAndRethrow(x)}}Q.setSuccess()}catch(v){Q.setFailureAndRethrow(v)}n.setPercentage(75);const M=ae().startOperation("Sort the Transactions table");try{const v=[{key:T.findIndex(C=>C==="date"),sortOn:Excel.SortOn.value,ascending:!1},{key:T.findIndex(C=>C==="plaid:authorized_datetime"),sortOn:Excel.SortOn.value,ascending:!1},{key:T.findIndex(C=>C==="Account"),sortOn:Excel.SortOn.value,ascending:!0},{key:T.findIndex(C=>C==="Payer"),sortOn:Excel.SortOn.value,ascending:!0},{key:T.findIndex(C=>C==="payee"),sortOn:Excel.SortOn.value,ascending:!0},{key:T.findIndex(C=>C==="plaid:datetime"),sortOn:Excel.SortOn.value,ascending:!1},{key:T.findIndex(C=>C===_e.LunchId),sortOn:Excel.SortOn.value,ascending:!0}].filter(C=>C.key>=0);c.sort.apply(v),await a.excel.sync(),M.setSuccess()}catch(v){M.setFailureAndRethrow(v)}n.setPercentage(80),await Fs(c,T,l,a),n.setPercentage(90),await Vs(c,a),c.getRange().format.autofitColumns(),await a.excel.sync(),n.setPercentage(100),r.setSuccess()}catch(l){o.values=[[`ERR: ${xe(l)}`]],o.format.font.color="#FF0000",await a.excel.sync(),r.setFailureAndRethrow(l)}}let Nt=!1;async function Ds(e,t,a,n){const s=De();if(Nt===!0)throw new Error("Cannot start data download, because data sync is already in progress.");const o=s.tracker.startOperation("Download Data",{updateExistingTransactions:a});o.addInfo({startDate:e,endDate:t}),e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()&&(t.setDate(t.getDate()+1),o.addInfo("Moved End Date one day later to work about a Lunch Money bug",{startDate:e,endDate:t}));let r=!0;try{Nt=!0,r=De().isImportantOperationOngoing.value,s.setImportantOperationOngoing(!0);const l=await ta(),d={version:l.lastCompletedSyncVersion.value+1,utc:new Date};{const c=l.apiToken.value;if(he(c)){o.setFailure("No API token. Cannot proceed with download");return}o.addInfo(`downloadData(..): has API token (${c.length} chars).`)}await Excel.run(async c=>{const w=await Bt(Es,c),T=await Bt(bs,c),y=await Bt(Cs,c),A={excel:c,currentSync:d,isUpdateExistingTransactions:a,progressPercentage:n,sheets:{trans:w,tags:T,cats:y},tags:{assignable:new Map,groupListFormulaLocations:new Map,byId:new Map},cats:{assignable:new rt,listFormulaLocation:null}};await Ts(A),await ks(A),await Bs(e,t,A)}),l.lastCompletedSyncUtc.value=d.utc,l.lastCompletedSyncVersion.value=d.version,o.setSuccess()}catch(l){o.setFailureAndRethrow(l)}finally{n.value=100,s.setImportantOperationOngoing(r),Nt=!1}}let Ut=!1;function zs(e){if(he(e))return"<empty>";const t=e.length;return t<9?`(${t} chars)`:e.substring(0,3)+"..."+e.substring(e.length-3)+` (${t} chars)`}async function Ns(e){const t=De();if(Ut===!0)return{isValid:!1,info:`Cannot validate token:
 Validation already in progress.`};const a=zs(e),n=t.tracker.startOperation("Validate API Token",a);try{if(Ut=!0,he(e)){const w="Specified API token is empty.";return n.setFailure(w),{isValid:!1,info:w}}const s=new Headers;s.append("Authorization",`Bearer ${e}`);const r=await fetch("https://dev.lunchmoney.app/v1/me",{method:"GET",headers:s,redirect:"follow"});if(r.status===401){const w="Specified API token does not exist or is not valid.";return n.setFailure(w),{isValid:!1,info:w}}const l=r.ok?await r.text():await xt("GET","me","get API token user info"),d=JSON.parse(l);if(d===void 0&&d===null)throw new Error("Cannot parse API token's user info");const c=w=>{if(!(w in d))throw new Error(`API token's user info fetched and parsed, but it does not contain '${w}'.`)};return c("user_name"),c("user_email"),c("user_id"),c("account_id"),c("budget_name"),c("primary_currency"),c("api_key_label"),n.setSuccess(),{isValid:!0,info:d}}catch(s){return n.setFailure(s),{isValid:!1,info:xe(s)}}finally{Ut=!1}}const Us={class:"text-left q-gutter-md",style:{width:"fit-content"}},Hs={key:0,class:"q-pa-sm form-group-border",style:{"font-size":"smaller",color:"red",width:"auto"}},js={key:1,class:"q-pa-sm form-group-border",style:{"font-size":"smaller",width:"auto"}},Ks={class:"q-pa-sm form-group-border",style:{width:"auto"}},Qs={style:{padding:"0",margin:"0px","text-align":"right"}},Ws={class:"q-pa-sm form-group-border",style:{width:"auto"}},Gs={class:"q-mb-sm"},Ys={class:"date-inputs",style:{display:"flex",gap:"5px"}},Zs={style:{"max-width":"120px",width:"100%"}},Xs={key:0,class:"text-negative q-mt-xs"},Js={style:{"max-width":"120px",width:"100%"}},er={key:0,class:"text-negative q-mt-xs"},tr={class:"q-pa-sm form-group-border",style:{width:"auto"}},ar={class:"q-pa-sm q-mt-md q-mb-sm form-group-border",style:{"font-size":"smaller",width:"auto"}},nr={key:0},or={key:0},sr={key:1},rr=At({__name:"SyncTab",setup(e){const t=B(""),a=B(null);let n;const s=B(""),o=B(!1),r=B("API token not verified."),l=B(void 0),d=B(!1),c=O(()=>d.value===!0?"Token is being verified...":l.value===void 0?"Token not verified."+(o.value?"":" Expand to configure."):l.value?"Token is valid":"Token not valid."+(o.value?"":" Expand to configure.")),w=B(!1),T=B(!1),y=O({get:()=>T.value,set:u=>{u?w.value=!0:T.value=!1}});async function A(u){d.value=!0;try{r.value="API token is being verified.",l.value=!1;const{isValid:i,info:_}=await Ns(u);return i?r.value=`Token is valid.
 Token moniker:    ${_.api_key_label??"<Not Named>"}
 Grants access to: ${_.budget_name??"<Unnamed Budget>"}
 User:             ${_.user_name??"Unnamed User"} (${_.user_email??"NoEmail"})`:r.value=_,l.value=i,i}finally{d.value=!1}}async function I(){const u=(s.value??"").trim();if(r.value="API token not verified.",l.value=!1,!y.value)try{await n.clearTokenStorage()}catch(_){console.error("Error removing the API token from the document!",_)}const i=await A(u);try{n.apiToken.value=u,y.value&&await n.storeApiToken()}catch(_){console.error("Error setting or storing API token in App Settings.",_)}return i?u:void 0}function $(u){u==="yes"&&(T.value=!0),w.value=!1}const k=Vn({lastSync:null,recent:null,last24Months:null});function N(u){if(u.getDate()>=1&&u.getDate()<=19){const i=new Date(u.getFullYear(),u.getMonth()-1,1);return Ye(i)}else{const i=new Date(u.getFullYear(),u.getMonth(),1);return Ye(i)}}function Q(u){const E=new Date(u.getTime()-63072e6);return Ye(E)}function M(){const u=new Date,i=Ye(u);try{const _=n.lastCompletedSyncUtc.value;k.lastSync=_===null?null:{start:Ye(_),end:i}}catch{}k.recent={start:N(u),end:i},k.last24Months={start:Q(u),end:i}}function v(u){u!==null&&(ut().capture("applyDownloadDatesQuickSelect",{applyRange:u===k.lastSync?"lastSync":u===k.recent?"recent":u===k.last24Months?"last24Months":"unknownOption"}),z.value=u.start,m.value=u.end)}const C=u=>u?new Date(u).getUTCFullYear()>=2010||"YEAR must be 2010 or later.":!0,f=B(-1),x=O(()=>{const u=0<=f.value&&f.value<100,i=d.value===!0;return u||i}),q=B(!1),z=B(""),m=B(""),g=B(""),R=B("");async function S(){ut().capture("validateAndDownload",{step:1}),g.value="",R.value="";let u=z.value,i=m.value;if(he(u))g.value="Please select a START date.";else{const F=C(u);g.value=F===!0?"":"date too old"}if(he(i))R.value="Please select an END date.";else{const F=C(i);R.value=F===!0?"":"date too old"}if(!he(g.value)||!he(R.value))return;let _=new Date(u),E=new Date(i);if(_>E){const F=u;z.value=u=i,m.value=i=F,_=new Date(u),E=new Date(i)}if(g.value||R.value)return;if(await I()===void 0){o.value=!0;return}const h=q.value;ut().capture("validateAndDownload",{step:2});try{f.value=0;try{await Ds(_,E,h,f),vo("Data download complete"),M(),ut().capture("validateAndDownload",{step:3})}catch(F){ho("Error while downloading data! (see status log for details)",xe(F))}}finally{f.value=-1}}return Qe(async()=>{const u=ae().startOperation("ExpLens Excel-AddIn: SyncData Tab mounted. Getting Office API ready...");try{try{a.value=await Wa(!0)}catch(E){E instanceof Error?t.value=E.message:t.value="Unexpected error while getting office APIs ready: "+fo(E),u.setFailure("Error getting office APIs ready. AddIn will not work!",{message:t.value,error:E}),console.error("Error getting office APIs ready. AddIn will not work!",{message:t.value,error:E});return}t.value="",n=await ta();const i=n.apiToken.value??"";s.value=i,T.value=i.length>0;const _=await A(i);o.value=!_,J(n.apiToken,async E=>{const h=E??"";s.value!==h&&(s.value=h,await A(h))}),M(),v(k.lastSync??k.recent),u.setSuccess()}catch(i){u.setFailureAndRethrow(i)}}),(u,i)=>(de(),we(Dn,null,[H("div",Us,[i[21]||(i[21]=H("h2",{class:"q-ma-md tab-main-header"},"Synchronize Bank Data",-1)),t.value?(de(),we("div",Hs,ce(t.value),1)):Ee("",!0),be(he)(t.value)&&a.value===null?(de(),we("div",js," Office Add-In environment not initialized (yet?). ")):Ee("",!0),H("div",Ks,[K(go,{id:"api-token-expansion",modelValue:o.value,"onUpdate:modelValue":i[2]||(i[2]=_=>o.value=_),label:"Lunch Money Access Token",caption:o.value?"":c.value,dense:"","dense-toggle":""},{default:te(()=>[K(be(Vt),{modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=_=>s.value=_),disable:x.value,filled:"",label:"API Token",dense:"",counter:!1,maxlength:"200",style:{"max-width":"450px",width:"100%",padding:"0 10px 20px 0"}},null,8,["modelValue","disable"]),K(Vo,{modelValue:y.value,"onUpdate:modelValue":i[1]||(i[1]=_=>y.value=_),disable:x.value,style:{"font-size":"smaller","line-height":"normal"}},{default:te(()=>[...i[14]||(i[14]=[ie("Store the API Token in the current document",-1),H("br",null,null,-1),H("span",{style:{"font-size":"smaller"}},"(Unsecure!)",-1)])]),_:1},8,["modelValue","disable"]),H("div",Qs,[K(Pe,{label:"Apply",disable:x.value,color:"primary",onClick:I,class:"q-ma-sm",dense:"","no-caps":""},null,8,["disable"])]),H("pre",{class:"q-ma-xs",style:Bn({fontFamily:"monospace",fontSize:"10px",lineHeight:1,color:!d.value&&!l.value?"red":"black"})},ce(r.value),5)]),_:1},8,["modelValue","caption"])]),H("div",Ws,[i[16]||(i[16]=H("div",{class:"text-weight-bold q-mb-xs",style:{"font-size":"0.9rem"}},"Download transactions for dates:",-1)),H("div",Gs,[i[15]||(i[15]=H("div",{class:"text-primary text-weight-bold q-mb-xs",style:{"font-size":"0.7rem"}},"Quick select:",-1)),K(Pe,{color:"primary",outline:"","no-wrap":"","no-caps":"",dense:"",label:"Since Last Sync",style:{"font-size":"0.8rem"},class:"q-mr-xs",disable:x.value||k.lastSync===null,onClick:i[3]||(i[3]=_=>v(k.lastSync))},{default:te(()=>[k.lastSync?(de(),pt(je,{key:0,anchor:"top middle",self:"bottom middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[ie(ce(k.lastSync?.start)+" ... "+ce(k.lastSync?.end),1)]),_:1})):Ee("",!0)]),_:1},8,["disable"]),K(Pe,{color:"primary",outline:"","no-wrap":"","no-caps":"",dense:"",label:"Recent",style:{"font-size":"0.8rem"},class:"q-mr-xs",disable:x.value||k.recent===null,onClick:i[4]||(i[4]=_=>v(k.recent))},{default:te(()=>[k.recent?(de(),pt(je,{key:0,anchor:"top middle",self:"bottom middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[ie(ce(k.recent?.start)+" ... "+ce(k.recent?.end),1)]),_:1})):Ee("",!0)]),_:1},8,["disable"]),K(Pe,{color:"primary",outline:"","no-wrap":"","no-caps":"",dense:"",label:"Last 24 months",style:{"font-size":"0.8rem"},disable:x.value||k.last24Months===null,onClick:i[5]||(i[5]=_=>v(k.last24Months))},{default:te(()=>[k.last24Months?(de(),pt(je,{key:0,anchor:"top middle",self:"bottom middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[ie(ce(k.last24Months?.start)+" ... "+ce(k.last24Months?.end),1)]),_:1})):Ee("",!0)]),_:1},8,["disable"])]),H("div",Ys,[H("div",Zs,[K(be(Vt),{disable:x.value,filled:"",label:"START",modelValue:z.value,"onUpdate:modelValue":[i[6]||(i[6]=_=>z.value=_),i[7]||(i[7]=_=>g.value="")],type:"date",error:!!g.value,rules:[C],style:{"font-size":"0.75rem"}},null,8,["disable","modelValue","error","rules"]),g.value?(de(),we("div",Xs,ce(g.value),1)):Ee("",!0)]),H("div",Js,[K(be(Vt),{disable:x.value,filled:"",label:"END",modelValue:m.value,"onUpdate:modelValue":[i[8]||(i[8]=_=>m.value=_),i[9]||(i[9]=_=>g.value="")],type:"date",error:!!R.value,rules:[C],style:{"font-size":"0.75rem"}},null,8,["disable","modelValue","error","rules"]),R.value?(de(),we("div",er,ce(R.value),1)):Ee("",!0)])]),i[17]||(i[17]=H("div",{class:"text-weight-bold q-mb-xs",style:{"font-size":"0.9rem"}},"Download method:",-1)),K(mo,{modelValue:q.value,"onUpdate:modelValue":i[10]||(i[10]=_=>q.value=_),disable:x.value,color:"indigo-3","toggle-color":"indigo-6",unelevated:"","no-wrap":"","no-caps":"",dense:"",options:[{value:!0,label:"Overwrite Existing",icon:"note_alt",attrs:{style:"font-size: 0.7rem"}},{value:!1,label:"Download New Only",icon:"note_add",attrs:{style:"font-size: 0.7rem"}}]},null,8,["modelValue","disable"]),K(Kt,{class:"q-ma-sm q-mt-md q-mb-md",color:"grey-6"}),K(Pe,{icon:q.value?"note_alt":"note_add",label:"Download",loading:x.value,percentage:f.value,color:"primary",onClick:S,class:"q-ma-xs block q-mx-auto"},null,8,["icon","loading","percentage"])]),H("div",tr,[i[18]||(i[18]=H("div",{class:"text-weight-bold text-grey-6 q-mb-xs",style:{"font-size":"0.9rem"}},"Upload transactions:",-1)),i[19]||(i[19]=H("div",{class:"text-weight-bold text-grey-6 q-mb-sm",style:{"font-size":"0.7rem"}},[ie(" Only modifications to Categories and Tags will be uploaded."),H("br"),ie(" ("),H("span",{style:{"background-color":"#b5e6a2",color:"#4ea72e"}},"columns with green on top"),ie(") ")],-1)),i[20]||(i[20]=H("div",{class:"q-mb-md text-grey-8",style:{"font-size":"0.9rem"}},"Supported in future versions.",-1)),K(Kt,{class:"q-ma-sm q-mt-md q-mb-md",color:"grey-4"}),K(Pe,{disable:"",icon:"cloud_upload",label:"Upload",loading:x.value,percentage:f.value,color:"grey-6",class:"q-ma-xs block q-mx-auto"},null,8,["loading","percentage"])]),H("div",ar,[a.value?(de(),we("div",nr,[H("div",null," Connected to MS Office. Host: '"+ce(a.value.host??"null")+"'; Platform: '"+ce(a.value.platform??"null")+"'. ",1),be(n)?(de(),we("div",or," Last sync: "+ce(be(n).lastCompletedSyncUtc.value?be(po)(be(n).lastCompletedSyncUtc.value):"never")+" (#"+ce(be(n).lastCompletedSyncVersion.value)+"). ",1)):Ee("",!0)])):(de(),we("div",sr,"Office Add-In environment not initialized (yet?)."))])]),K(Wo,{modelValue:w.value,"onUpdate:modelValue":i[13]||(i[13]=_=>w.value=_),persistent:""},{default:te(()=>[K(zo,null,{default:te(()=>[K(Bo,null,{default:te(()=>[...i[22]||(i[22]=[H("div",{class:"text-weight-bold q-mb-sm",style:{"font-size":"larger"}}," Really store the API Token as clear text in this document? ",-1),H("p",{class:"text-weight-bold"},"Anybody who can access this document can also access the token.",-1),H("p",{class:"text-justify q-mb-xs"},[ie(" The API Token enables complete access to all your data inside of Lunch Money."),H("br"),ie(" We can store the API Token in the current document for your convenience. However, the Token is not encrypted, and anybody with access to this document can theoretically also access the Token. ")],-1),H("p",{class:"text-justify q-mb-xs"},[ie(" If you ever suspect that an unauthorized person accessed your API Token, you must immediately delete it (you can create a new one right away). To do that, go to "),H("span",{class:"text-italic"},"Settings > Developers"),ie(" in your Lunch Money app."),H("br"),ie(" ("),H("a",{target:"_blank",href:"https://my.lunchmoney.app/developers"},"https://my.lunchmoney.app/developers"),ie("). ")],-1)])]),_:1}),K(Do,{align:"right"},{default:te(()=>[Ht(K(Pe,{flat:"",label:"No",color:"positive",onClick:i[11]||(i[11]=_=>$("no"))},null,512),[[va]]),Ht(K(Pe,{flat:"",label:"Yes",color:"negative",onClick:i[12]||(i[12]=_=>$("yes"))},null,512),[[va]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),lr={class:"text-left q-gutter-md"},ir=At({__name:"AnalyzeTab",setup(e){return(t,a)=>(de(),we("div",lr,[...a[0]||(a[0]=[H("h2",{class:"q-ma-md tab-main-header"},"Analyze Transactions",-1),H("p",null,"This function is not yet available in the current preview version.",-1),H("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. ",-1)])]))}}),ur={class:"text-left q-gutter-md"},cr=At({__name:"SettingsTab",setup(e){return(t,a)=>(de(),we("div",ur,[...a[0]||(a[0]=[H("h2",{class:"q-ma-md tab-main-header"},"App Settings",-1),H("p",null,"This function is not yet available in the current preview version.",-1),H("p",null," Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. ",-1)])]))}}),dr={class:"main-content q-pa-md"},fr={class:"title-bar"},gr={class:"title-version"},mr=At({__name:"IndexPage",setup(e){console.debug("ExpLens Excel-AddIn: Loading IndexPage...");function t(){let s="0.0.3";const o=".0.0";return s.endsWith(o)&&(s=s.slice(0,s.length-o.length)),s}const a=t(),n=B("sync");return Qe(async()=>{}),(s,o)=>(de(),pt(Lo,{class:"row justify-center"},{default:te(()=>[H("div",dr,[H("div",fr,[o[2]||(o[2]=H("h1",{class:"title-name"},"ExpLens",-1)),H("div",gr,ce(be(a)),1),o[3]||(o[3]=H("img",{src:"icons/favicon-32x32.png",alt:"Logo",class:"title-logo"},null,-1))]),K(ko,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=r=>n.value=r),"inline-label":"",align:"center",class:"q-mb-md","indicator-color":"tab-bar-active"},{default:te(()=>[K(qt,{name:"sync"},{default:te(()=>[K(Te,{name:"currency_exchange",size:"sm"}),K(je,{anchor:"bottom middle",self:"top middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[...o[4]||(o[4]=[ie(" Synchronize Bank Data ",-1)])]),_:1})]),_:1}),K(qt,{name:"analyze"},{default:te(()=>[K(Te,{name:"analytics",size:"sm"}),K(je,{anchor:"bottom middle",self:"top middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[...o[5]||(o[5]=[ie(" Analyze Transactions ",-1)])]),_:1})]),_:1}),K(qt,{name:"settings"},{default:te(()=>[K(Te,{name:"settings",size:"sm"}),K(je,{anchor:"bottom middle",self:"top middle",offset:[5,5],class:"tooltip-semitransp"},{default:te(()=>[...o[6]||(o[6]=[ie(" App Settings ",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),K(Kt,{class:"q-mb-sm"}),K($o,{modelValue:n.value,"onUpdate:modelValue":o[1]||(o[1]=r=>n.value=r),"keep-alive":"",animated:""},{default:te(()=>[K(Ot,{name:"sync",class:"q-pa-none"},{default:te(()=>[K(rr)]),_:1}),K(Ot,{name:"analyze",class:"q-pa-none"},{default:te(()=>[K(ir)]),_:1}),K(Ot,{name:"settings",class:"q-pa-none"},{default:te(()=>[K(cr)]),_:1})]),_:1},8,["modelValue"])])]),_:1}))}}),yr=yo(mr,[["__scopeId","data-v-4cc598f4"]]);export{yr as default};
